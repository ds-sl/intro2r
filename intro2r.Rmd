---
title: "Introduction to R"
date: "`r Sys.Date()`"
output: 
  html_notebook:
#    df_print: paged
    number_sections: yes
#    toc: true
#    toc_float: true
---
# Introduction

## Before We Start


1. We will introduce the basics of the Data Analysis focusing on handling and visualizing data.
  - Handle Data: Importing, Viewing, Tidying, and Transforming
  - Visualize Data
  - Analyse Data using Models

![_The image above is from [R4DS](https://r4ds.had.co.nz) by Hadley Wickham and Garrett Grolemund_](./fig/data-science.png)
  
2. Two Keys and One Comment:
  - Data Science is an **empirical science** rather than theoretical, and we must **'Learn by Doing'**.
  - In every scientific research, we need to keep in mind to **replicate** the process and results, and we must **'Keep Records'** to communicate.
  - The Instructor is not an experienced data scientist or a researcher using data analysis, but a beginner and a learner of data science. Let's learn together!
  
3. What do we learn?
  - R, a statistical computing language, using RStudio
  - The `tidyverse` package attaches `ggplot2`, `purrr`, `tibble`, `dplyr`, `tidyr`, `stringr`, `readr`, `forcats` as well.
  - The `rmarkdown` package to analyze, share and reproduce.


## R, RStudio and Packages

### Setup

We need both R and RStudio. 
If you have not installed R and RStudio, please follow the instruction in ModernDive: [Chapter 1 Getting Started with Data in R](https://moderndive.netlify.app/1-getting-started.html#getting-started) .

#### R

> R is ‘GNU S’, a freely available language and environment for statistical computing and graphics which provides a wide variety of statistical and graphical techniques: linear and nonlinear modelling, statistical tests, time series analysis, classification, clustering, etc. 

**The R Project for Statistical Computing:** https://www.r-project.org

* The R Manuals: https://cran.r-project.org/manuals.html

**Update R**

Currently, R version 4.2.1 (2022-06-23), recommended to update once a year. If you are Windows user, you can use the following code.

```{r eval = FALSE}
if( !("installr" %in% installed.packages()) ){install.packages("installr")}
installr::updateR(TRUE)
```

**System Language**

It is more convenient to set the system language of R to be English. You can copy and paste error message for search solutions.

```{r eval = FALSE}
Sys.setenv(LANG = "en")
```

#### RStudio

**RStudio Site:** https://www.rstudio.com

> Inspired by innovators in science, education, government, and industry, RStudio develops free and open tools for R, and enterprise-ready professional products for teams who use both R and Python, to scale and share their work. ([About RStudio: Inspiration](https://www.rstudio.com/about/))


**Update RStudio**

Top Menu > Help > Check for Updates

#### Packages

> R packages are extensions to the R statistical programming language. R packages contain code, data, and documentation in a standardised collection format that can be installed by users of R, typically via a centralised software repository such as CRAN (the Comprehensive R Archive Network).

**Install packages**

We need two packages, `rmarkdown` and `tidyverse`. Install these by the following code. You can also copy `install.packages(c("rmarkdown", "tidyverse"))` and paste in Console. You can also use Tools > Install Packages in the top menu.


* RBasics and/or `tidyverse`
  - tidyverse: https://www.tidyverse.org
* RMarkdown

```{r eval = FALSE}
install.packages(c("rmarkdown", "tidyverse"))
```

When you use a package you need to attach it by the following code.

```{r}
library(tidyverse)
```

* Additional packages
  - `WDI`


### References {-}

* ModernDive: [Chapter 1 Getting Started with Data in R](https://moderndive.netlify.app/1-getting-started.html#getting-started) 
* R-Ladies Sydney: [BasicBasics](https://rladiessydney.org/courses/ryouwithme/01-basicbasics-1/)


# Introduction to Data Analysis

## First Example

### Importing data

Let us assign the `iris` data in the pre-installed package `datasets` to `df_iris`. You can give any name starting from an alphabet, though there are some rules. 

```{r}
df_iris <- datasets::iris
class(df_iris)
```

The class of data `iris` is `data.frame`, the basic data class of R. You can assign the same data as a `tibble`, the data class of `tidyverse` as follows.

```{r}
tbl_iris <- as_tibble(datasets::iris)
class(tbl_iris)
```

### Look at the data

#### Several ways to view the data.

```{r viewiris, eval = FALSE}
View(df_iris)
```

```{r dfiris}
df_iris
```

The output within R Notebook is a tibble style. Try the same command in Console.

```{r slice10iris}
slice(df_iris, 1:10)
```
```{r one2ten}
1:10
```

```{r sequence}
seq(1,10)
```


#### Data Structure

```{r glimpse:eiris}
glimpse(df_iris)
```
There are six types of data in R; Double, Integer, Character, Logical, Raw, Complex.

```{r}
typeof(df_iris$Species)
```

```{r}
class(df_iris$Species)
```

```{r}
typeof(df_iris$Sepal.Length)
class(df_iris$Sepal.Length)
```


**Q1.** What are the differences of`df_iris`, `slice(df_iris, 1:10)` and `glimpse(df_iris)` above?

**Q2.** What are the differences of`df_iris`, `slice(df_iris, 1:10)` and `glimpse(df_iris)` in the console?

#### Summary of the Data

The following is very convenient to get the summary information of a data.

```{r}
summary(df_iris)
```
Minimum, 1st Quadrant (25%),  Median, Mean, 3rd Quadrant (75%), Maximum, and the count of each factor.

### Visualizing Data

#### Scatter Plot

```{r}
ggplot(data = df_iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  geom_point()
```
#### Scatter Plot with Labels

```{r}
ggplot(data = df_iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  geom_point() + 
  labs(title = "Scatter Plot of Sepal Data of Iris", x = "Sepal Length", y = "Sepal Width")
```
#### Scatter Plot with Colors

```{r}
ggplot(data = df_iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
  geom_point()
```
#### Boxplot


```{r}
ggplot(data = df_iris, aes(x = Species, y = Sepal.Length)) +
  geom_boxplot()
```



#### Histogram

```{r}
ggplot(data = df_iris, aes(x = Sepal.Length)) +
  geom_histogram()
```
```{r}
ggplot(data = df_iris, aes(x = Sepal.Length)) +
  geom_histogram(bins = 10)
```
### Various Plots of Density

```{r}
ggplot(data = df_iris, aes(x = Species, y = Sepal.Length)) +
  geom_violin()
```

```{r}
ggplot(data = df_iris, aes(x = Species, y = Sepal.Length)) +
  geom_jitter(width = 0.2)
```

```{r}
ggplot(data = df_iris, aes(x = Sepal.Length, fill = Species)) +
  geom_density(alpha = 0.5)
```

### Data Modeling 

Linear Regression Model

```{r}
ggplot(data = df_iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
```{r}
lm(Sepal.Width ~ Sepal.Length, data = df_iris)
```

The formular of the line in the scattered plot is the following.
$$y = (-0.06188)x + 3.41895$$
The slope is $-0.06188$ and the $y$-intercept is 3.41895. 

It is a little strange and counter intuitive, because it claims that as the sepal width gets smaller as the sepal length gets larger. What is hidden behind?

```{r}
lm(Sepal.Width ~ Sepal.Length, data = df_iris) %>% summary()
```
```{r}
ggplot(data = df_iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
```{r iris:sepal:confounder}
ggplot(df_iris, aes(x = Sepal.Length, y = Sepal.Width)) + 
  geom_point(aes(color = Species)) + 
  geom_smooth(aes(color = Species), formula = y ~ x, method = "lm", se = FALSE) +
  geom_smooth(formula =  y ~ x, method = "lm", se = FALSE, color = "black", linetype = "twodash", size = 1.5)
```

# About Data


# Data Wrangling


# Data Visualization

## ggplot2

* [R for Data Science](https://r4ds.had.co.nz/)
  - [3. Data Visualisation](https://r4ds.had.co.nz/data-visualisation.html#data-visualisation)
  - [28. Graphics for communication](https://r4ds.had.co.nz/graphics-for-communication.html)
* [ggplot2 page in tidyverse](https://ggplot2.tidyverse.org)
* [ggplot2 extensions - gallery](https://exts.ggplot2.tidyverse.org/gallery/)
* [ggplot2 Cheatsheet](https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf)

# Data Modeling


# References

## Data

**Data sets**

1. [DFID portal](https://devtracker.dfid.gov.uk/)
2. [EU Aid portal](https://euaidexplorer.ec.europa.eu/)
3. [Eurostat](https://ec.europa.eu/eurostat)
4. [FAOSTAT](http://www.fao.org/faostat/en/#home)
5. [Openaid Netherlands](http://openaid.nl/)
6. [Openaid Sweden](http://openaid.se/aid/)
7. [Oxfam data sets](https://policy-practice.oxfam.org.uk/our-approach/accountability-and-transparency/our-data)
8. [Sea Around Us (University of British Columbia)](http://www.seaaroundus.org/data/#/eez)
9. [UN Habitat portal](http://open.unhabitat.org/)
10. [UNESCO portal](http://opendata.unesco.org/)
12. [USAID portal](http://open.undp.org/)
13. [World Poverty Clock (World Data Lab)](https://aidscape.usaid.gov/)


## Books

You can read many excellent books online.

* [RStudio > Resources > Books](https://www.rstudio.com/resources/books/)
* [Bookdown](https://bookdown.org) and its [archive](https://bookdown.org/home/archive/) page

## Websites

* [RStudio](https://www.rstudio.com)
  - Education: https://education.rstudio.com
* R Basics:
  - [R for Beginners](https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf) in PDF
  - [Quick-R by DataCamp](https://www.statmethods.net/r-tutorial/index.html)
* Data Science for Social Scientists: https://datascience.tntlab.org
  - R for Social Scientists: https://datacarpentry.org/r-socialsci/
  
* RMarkdown
  - [RStudio Site](https://rmarkdown.rstudio.com/index.html)

## Interactive Exercises


