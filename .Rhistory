df_serv_long |> drop_na(value) |>
ggplot(aes(year, col = name)) + geom_bar()
df_serv_long |> drop_na(value) |>
ggplot(aes(year, fill = name)) + geom_bar()
df_serv |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_serv |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
df_serv |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c,region,income)
df_serv |> filter(!(iso2c %in% REGION)) |> # 地域以外（国のみ選択）
drop_na(electricity_urban:sanitation_rural) |>
select(electricity_urban:sanitation_rural) |> cor()
df_serve |> filter(country %in% c("Brunei", "Burma", "Cambodia", "Laos", "Myanmar",
"Philippines", "Indonesia", "Malaysia", "Singapore", "Vietnam")) |> distinct(iso2c) |> dput()
df_serv |> filter(country %in% c("Brunei", "Burma", "Cambodia", "Laos", "Myanmar",
"Philippines", "Indonesia", "Malaysia", "Singapore", "Vietnam")) |> distinct(iso2c) |> dput()
df_serv |> filter(country %in% c("Brunei", "Burma", "Cambodia", "Lao", "Myanmar",
"Philippines", "Indonesia", "Malaysia", "Singapore", "Vietnam")) |> distinct(iso2c) |> dput()
df_serv |> filter(country %in% c("Brunei Darussalam", "Cambodia", "Lao PDR", "Myanmar",
"Philippines", "Indonesia", "Malaysia", "Singapore", "Viet Nam")) |> distinct(iso2c) |> dput()
ASEAN <-  |> c("BN", "KH", "ID", "LA", "MY", "MM", "PH", "SG", "VN")
ASEAN <- c("BN", "KH", "ID", "LA", "MY", "MM", "PH", "SG", "VN")
ASEAN <- c("BN", "KH", "ID", "LA", "MY", "MM", "PH", "SG", "VN")
BRICS <- c("Brazil", "Russian Federation", "India", "China", "South Africa")
SACU <- c("South Africa", "Namibia", "Eswatini", "Botswana", "Lesotho")
CHOSEN_COUNTRIES <- c("Suriname", "Belize", "Brazil", "Colombia")
df_serv_long |> filter(country == "Japan") |> drop_na(value) |>
ggplot(aes(year, value, col = name)) + geom_line()
df_serv_long |> filter(country == "Japan") |> drop_na(value)
df_serv_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()
df_serv_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
filter(value < 90) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()
df_serv_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
filter(value < 80) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()
df_serv_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
filter(value < 80) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()
df_serv_long |> filter(iso2c %in% SACU) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()
df_serv_long |> filter(country %in% SACU) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()
df_serv |> filter(name == "electricity_rural") |> drop_na(value) |>
ggplot(aes(region, value)) + geom_boxplot()
df_serv_long |> filter(name == "electricity_rural") |> drop_na(value) |>
ggplot(aes(region, value)) + geom_boxplot()
df_serv_long |> filter(name == "electricity_rural") |> drop_na(value) |>
ggplot(aes(region, value)) + geom_boxplot() + cord_flip()
df_serv_long |> filter(name == "electricity_rural") |> drop_na(value) |>
ggplot(aes(region, value)) + geom_boxplot() + coord_flip()
df_serv_long |> filter(name == "electricity_rural") |>
filter(region != "Aggregates") |> drop_na(value) |>
ggplot(aes(region, value)) + geom_boxplot() + coord_flip()
df_serv |> filter(region != "Aggregates") |> drop_na(value) |>
ggplot(aes(region, electricity_rural)) + geom_boxplot() + coord_flip()
df_serv |> filter(region != "Aggregates") |> drop_na(electricity_rural) |>
ggplot(aes(region, electricity_rural)) + geom_boxplot() + coord_flip()
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/ges001/ges00120.Rmd")
df_unemploy <- WDI(indicator = c(female_unemploy = "SL.UEM.TOTL.FE.ZS",
male_unemploy = "SL.UEM.TOTL.FE.ZS"),
extra = TRUE)
write_csv(df_unemploy, "data/unemploy.csv")
df_unemploy <- read_csv("data/unemploy.csv")
df_unemploy
str(df_unemploy)
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_unemploy |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
df_unemploy |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c)
df_unemploy |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c, region, income)
df_unemploy |> filter(iso2c %in% ASEAN) |> distinct(country) |> dput()
df_unemploy <- WDI(indicator = c(female_unemploy = "SL.UEM.TOTL.FE.ZS",
male_unemploy = "SL.UEM.TOTL.MA.ZS"),
extra = TRUE)
df_unemploy <- WDI(indicator = c(female_unemploy = "SL.UEM.TOTL.FE.ZS",
male_unemploy = "SL.UEM.TOTL.MA.ZS"),
extra = TRUE)
df_unemploy <- WDI(indicator = c(female_unemploy = "SL.UEM.TOTL.FE.ZS"),
extra = TRUE)
df_unemploy <- WDI(indicator = c(female_unemploy = "SL.UEM.TOTL.MA.ZS"),
extra = TRUE)
df_unemploy <- WDI(indicator = c(female_unemploy = "SL.UEM.TOTL.FE.ZS",
male_unemploy = "SL.UEM.TOTL.MA.ZS"),
extra = TRUE)
write_csv(df_unemploy, "data/unemploy.csv")
df_unemploy <- read_csv("data/unemploy.csv")
df_unemploy
str(df_unemploy)
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_unemploy |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
df_unemploy |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c, region, income)
ASEAN <- c("BN", "KH", "ID", "LA", "MY", "MM", "PH", "SG", "VN")
asean <- c("Brunei Darussalam", "Cambodia", "Indonesia", "Lao PDR", "Malaysia", "Myanmar", "Philippines", "Singapore", "Viet Nam")
df_unemploy |> drop_na(female_unemploy, male_unemploy) |> filter(!(iso2c %in% REGION)) |>
ggplot(aes(year)) + geom_bar()
df_unemploy |> filter(country == "Japan") |> drop_na(unemploy_female) |>
ggplot(aes(year, unemploy_female)) + geom_line()
df_unemploy |> filter(country == "Japan") |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy)) + geom_line()
df_unemploy |> filter(country == "Japan") |> drop_na(male_unemploy) |>
ggplot(aes(year, female_unemploy)) + geom_line()
df_unemploy |> filter(iso2c %in% ASEAN) |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy, col = country)) + geom_line()
df_unemploy |> filter(country %in% asean) |> drop_na(male_unemploy) |>
ggplot(aes(year, female_unemploy, col = country)) + geom_line()
df_unemploy <- WDI(indicator = c(female_unemploy = "SL.UEM.TOTL.FE.ZS",
male_unemploy = "SL.UEM.TOTL.MA.ZS"),
extra = TRUE)
write_csv(df_unemploy, "data/unemploy.csv")
df_unemploy <- read_csv("data/unemploy.csv")
df_unemploy
str(df_unemploy)
df_unemp <- df_unemploy |>
select(country, iso2c, year, female_unemploy, male_unemploy, region, income)
df_unemp
df_unemp |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
df_unemp |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c, region, income)
df_unemp |> drop_na(female_unemploy, male_unemploy) |> filter(!(iso2c %in% REGION)) |>
ggplot(aes(year)) + geom_bar()
df_unemp |> filter(country == "Japan") |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy)) + geom_line()
df_unemploy |> filter(country == "Japan") |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy)) + geom_line()
df_unemp |> filter(country == "Japan") |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy)) + geom_line()
df_unemp |> filter(iso2c %in% ASEAN) |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy, col = country)) + geom_line()
df_unemp |> filter(country %in% asean) |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy, col = country)) + geom_line()
df_unemp_long <- df_unemp |> pivot_longer(cols = c(female_unemploy, male_unemploy))
df_unemp_long
df_unemp_long |> filter(country == "Japan") |> drop_na(value) |>
ggplot(aes(year, value, col = name)) + geom_line()
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(year, value, col = name)) + geom_line()
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point()
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point()
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE)
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE)
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |> cor()
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |> select(female_unemploy, male_unemploy) |> cor()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value) |>
ggplot(aes(name, value)) + geom_boxplot()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value) |>
ggplot(aes(name, value, fill = region)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value) |>
ggplot(aes(region, value, fill = region)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value) |>
ggplot(aes(region, value, fill = name)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, region) |>
ggplot(aes(region, value, fill = name)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, region) |>
ggplot(aes(income, value, fill = name)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, income) |>
ggplot(aes(income, value, fill = name)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, income) |> filter(income != "Not classified") |>
ggplot(aes(income, value, fill = name)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |>
drop_na(value) |>
ggplot(aes(factor(year), value, fill = name)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year %in% c(1991, 2001, 2011, 2021)) |>
drop_na(value) |>
ggplot(aes(factor(year), value, fill = name)) + geom_boxplot() + coord_flip()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year %in% c(1991, 2001, 2011, 2021)) |>
drop_na(value) |>
ggplot(aes(factor(year), value, fill = name)) + geom_boxplot()
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(country, value, fill = name)) + geom_boxplot()
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(country, value, fill = name)) + geom_boxplot() + coord_flip()
df_unemp |> filter(country == "Japan") |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy)) + geom_line() +
labs(title = "日本の女性労働者失業率")
df_unemp |> filter(country == "Japan") |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy)) + geom_line()　+
labs(title = "日本の男性労働者失業率")
df_unemp |> filter(iso2c %in% ASEAN) |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy, col = country)) + geom_line() +
labs(title = "ASEAN の女性労働者失業率")
df_unemp |> filter(country %in% asean) |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy, col = country)) + geom_line() +
labs(title = "ASEAN の男性労働者失業率")
df_unemp_long |> filter(country == "Japan") |> drop_na(value) |>
ggplot(aes(year, value, col = name)) + geom_line()  +
labs(title = "日本の男女別労働者失業率")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()  +
labs(title = "ASEAN の男女別労働者失業率")
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point()  +
labs(title = "労働者失業率：男女別相関")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
labs(title = "労働者失業率：男女別相関（回帰直線付）")
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point()  +
labs(title = "失業率：男女別相関")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()  +
labs(title = "ASEAN の男女別失業率")
df_unemp_long |> filter(country == "Japan") |> drop_na(value) |>
ggplot(aes(year, value, col = name)) + geom_line()  +
labs(title = "日本の男女別失業率")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
labs(title = "2022年の失業率：男女別相関")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "失業率：男女別相関（回帰直線付）")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(country, value, fill = name)) + geom_boxplot() + coord_flip() +
labs(title = "ASEAN の労働者失業率：男女別箱ひげ図")
library(tidyverse)
library(WDI)
df_unemploy <- read_csv("data/unemploy.csv")
df_unemploy
str(df_unemploy)
df_unemp <- df_unemploy |>
select(country, iso2c, year, female_unemploy, male_unemploy, region, income)
df_unemp
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_unemp |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
df_unemp |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c, region, income)
ASEAN <- c("BN", "KH", "ID", "LA", "MY", "MM", "PH", "SG", "VN")
asean <- c("Brunei Darussalam", "Cambodia", "Indonesia", "Lao PDR", "Malaysia", "Myanmar", "Philippines", "Singapore", "Viet Nam")
df_unemp |> drop_na(female_unemploy, male_unemploy) |> filter(!(iso2c %in% REGION)) |>
ggplot(aes(year)) + geom_bar()
df_unemp |> filter(country == "Japan") |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy)) + geom_line() +
labs(title = "日本の女性労働者失業率")
df_unemp |> filter(country == "Japan") |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy)) + geom_line()　+
labs(title = "日本の男性労働者失業率")
df_unemp |> filter(iso2c %in% ASEAN) |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy, col = country)) + geom_line() +
labs(title = "ASEAN の女性労働者失業率")
df_unemp |> filter(country %in% asean) |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy, col = country)) + geom_line() +
labs(title = "ASEAN の男性労働者失業率")
df_unemp_long <- df_unemp |> pivot_longer(cols = c(female_unemploy, male_unemploy))
df_unemp_long
df_unemp_long |> filter(country == "Japan") |> drop_na(value) |>
ggplot(aes(year, value, col = name)) + geom_line()  +
labs(title = "日本の男女別失業率")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()  +
labs(title = "ASEAN の男女別失業率")
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point()  +
labs(title = "失業率：男女別相関")
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "失業率：男女別相関（回帰直線付）")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
labs(title = "2022年の失業率：男女別相関")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "失業率：男女別相関（回帰直線付）")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |> select(female_unemploy, male_unemploy) |> cor()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value) |>
ggplot(aes(name, value)) + geom_boxplot()  +
labs(title = "労働者失業率：男女別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, region) |>
ggplot(aes(region, value, fill = name)) + geom_boxplot() + coord_flip()　+
labs(title = "労働者失業率：男女・地域別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, income) |> filter(income != "Not classified") |>
ggplot(aes(income, value, fill = name)) + geom_boxplot() + coord_flip()　+
labs(title = "労働者失業率：男女・収入レベル別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year %in% c(1991, 2001, 2011, 2021)) |>
drop_na(value) |>
ggplot(aes(factor(year), value, fill = name)) + geom_boxplot() +
labs(title = "労働者失業率：男女別・10年ごとの箱ひげ図")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(country, value, fill = name)) + geom_boxplot() + coord_flip() +
labs(title = "ASEAN の労働者失業率：男女別箱ひげ図")
library(tidyverse)
library(WDI)
df_unemploy <- read_csv("data/unemploy.csv")
df_unemploy
str(df_unemploy)
df_unemp <- df_unemploy |>
select(country, iso2c, year, female_unemploy, male_unemploy, region, income)
df_unemp
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_unemp |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
df_unemp |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c, region, income)
ASEAN <- c("BN", "KH", "ID", "LA", "MY", "MM", "PH", "SG", "VN")
asean <- c("Brunei Darussalam", "Cambodia", "Indonesia", "Lao PDR", "Malaysia", "Myanmar", "Philippines", "Singapore", "Viet Nam")
df_unemp |> drop_na(female_unemploy, male_unemploy) |> filter(!(iso2c %in% REGION)) |>
ggplot(aes(year)) + geom_bar()
df_unemp |> filter(country == "Japan") |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy)) + geom_line() +
labs(title = "日本の女性労働者失業率")
df_unemp |> filter(country == "Japan") |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy)) + geom_line()　+
labs(title = "日本の男性労働者失業率")
df_unemp |> filter(iso2c %in% ASEAN) |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy, col = country)) + geom_line() +
labs(title = "ASEAN の女性労働者失業率")
df_unemp |> filter(country %in% asean) |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy, col = country)) + geom_line() +
labs(title = "ASEAN の男性労働者失業率")
df_unemp_long <- df_unemp |> pivot_longer(cols = c(female_unemploy, male_unemploy))
df_unemp_long
df_unemp_long |> filter(country == "Japan") |> drop_na(value) |>
ggplot(aes(year, value, col = name)) + geom_line()  +
labs(title = "日本の男女別失業率")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()  +
labs(title = "ASEAN の男女別失業率")
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point()  +
labs(title = "失業率：男女別相関")
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "失業率：男女別相関（回帰直線付）")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
labs(title = "2022年の失業率：男女別相関")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "失業率：男女別相関（回帰直線付）")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |> select(female_unemploy, male_unemploy) |> cor()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value) |>
ggplot(aes(name, value)) + geom_boxplot()  +
labs(title = "労働者失業率：男女別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, region) |>
ggplot(aes(region, value, fill = name)) + geom_boxplot() + coord_flip()　+
labs(title = "労働者失業率：男女・地域別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, income) |> filter(income != "Not classified") |>
ggplot(aes(income, value, fill = name)) + geom_boxplot() + coord_flip()　+
labs(title = "労働者失業率：男女・収入レベル別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year %in% c(1991, 2001, 2011, 2021)) |>
drop_na(value) |>
ggplot(aes(factor(year), value, fill = name)) + geom_boxplot() +
labs(title = "労働者失業率：男女別・10年ごとの箱ひげ図")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(country, value, fill = name)) + geom_boxplot() + coord_flip() +
labs(title = "ASEAN の労働者失業率：男女別箱ひげ図")
df_serv_long |> filter(region != "Aggregates") |> drop_na(value) |>
ggplot(aes(income, value)) + geom_boxplot() + coord_flip()
df_serv_long |> filter(income != "Aggregates") |> drop_na(value) |>
ggplot(aes(income, value)) + geom_boxplot() + coord_flip()
df_serv_long |> filter(name %in% c("electricity_rural", "electricity_urban")) |>
filter(income != "Aggregates") |> drop_na(value) |>
ggplot(aes(income, value, col = name)) + geom_boxplot() + coord_flip()
df_serv_long |> filter(name %in% c("electricity_rural", "electricity_urban")) |>
filter(income != "Aggregates") |> drop_na(value) |>
ggplot(aes(income, value, fill = name)) + geom_boxplot() + coord_flip()
df_serv_long |> filter(income != "Aggregates", income != "Not classified") |> drop_na(value) |>
ggplot(aes(income, value, fill = name)) + geom_boxplot() + coord_flip()
library(tidyverse)
library(WDI)
df_unemploy <- read_csv("data/unemploy.csv")
df_unemploy
str(df_unemploy)
df_unemp <- df_unemploy |>
select(country, iso2c, year, female_unemploy, male_unemploy, region, income)
df_unemp
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_unemp |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
df_unemp |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c, region, income)
ASEAN <- c("BN", "KH", "ID", "LA", "MY", "MM", "PH", "SG", "VN")
asean <- c("Brunei Darussalam", "Cambodia", "Indonesia", "Lao PDR", "Malaysia", "Myanmar", "Philippines", "Singapore", "Viet Nam")
df_unemp |> drop_na(female_unemploy, male_unemploy) |> filter(!(iso2c %in% REGION)) |>
ggplot(aes(year)) + geom_bar()
df_unemp |> filter(country == "Japan") |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy)) + geom_line() +
labs(title = "日本の女性労働者失業率")
df_unemp |> filter(country == "Japan") |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy)) + geom_line()　+
labs(title = "日本の男性労働者失業率")
df_unemp |> filter(iso2c %in% ASEAN) |> drop_na(female_unemploy) |>
ggplot(aes(year, female_unemploy, col = country)) + geom_line() +
labs(title = "ASEAN の女性労働者失業率")
df_unemp |> filter(country %in% asean) |> drop_na(male_unemploy) |>
ggplot(aes(year, male_unemploy, col = country)) + geom_line() +
labs(title = "ASEAN の男性労働者失業率")
df_unemp_long <- df_unemp |> pivot_longer(cols = c(female_unemploy, male_unemploy))
df_unemp_long
df_unemp_long |> filter(country == "Japan") |> drop_na(value) |>
ggplot(aes(year, value, col = name)) + geom_line()  +
labs(title = "日本の男女別失業率")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(year, value, col = country, linetype = name)) + geom_line()  +
labs(title = "ASEAN の男女別失業率")
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point()  +
labs(title = "失業率：男女別相関")
df_unemp |> filter(!(iso2c %in% REGION)) |> drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "失業率：男女別相関（回帰直線付）")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
labs(title = "2022年の失業率：男女別相関")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |>
ggplot(aes(female_unemploy, male_unemploy)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "失業率：男女別相関（回帰直線付）")
df_unemp |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(female_unemploy, male_unemploy) |> select(female_unemploy, male_unemploy) |> cor()
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value) |>
ggplot(aes(name, value)) + geom_boxplot()  +
labs(title = "労働者失業率：男女別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, region) |>
ggplot(aes(region, value, fill = name)) + geom_boxplot() + coord_flip()　+
labs(title = "労働者失業率：男女・地域別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year == 2022) |>
drop_na(value, income) |> filter(income != "Not classified") |>
ggplot(aes(income, value, fill = name)) + geom_boxplot() + coord_flip()　+
labs(title = "労働者失業率：男女・収入レベル別箱ひげ図")
df_unemp_long |> filter(!(iso2c %in% REGION)) |> filter(year %in% c(1991, 2001, 2011, 2021)) |>
drop_na(value) |>
ggplot(aes(factor(year), value, fill = name)) + geom_boxplot() +
labs(title = "労働者失業率：男女別・10年ごとの箱ひげ図")
df_unemp_long |> filter(iso2c %in% ASEAN) |> drop_na(value) |>
ggplot(aes(country, value, fill = name)) + geom_boxplot() + coord_flip() +
labs(title = "ASEAN の労働者失業率：男女別箱ひげ図")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/ges001/ges00120.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/ges001/ges00120.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/ges001/ges00120.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/ges001/ges00120.Rmd")
install.packages(c("commonmark", "data.table", "DBI", "geepack", "hardhat", "httpuv", "infer", "listenv", "sp", "terra", "tidyr", "viridis", "zip"))
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/ges001/ges00120.Rmd")
