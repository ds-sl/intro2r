filter(year %in% c(1961, 1971, 1981, 1991, 2001, 2011, 2021)) %>%
ggplot(aes(gnppcap, fill = factor(year))) + geom_density(alpha = 0.4)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region  != "Aggregates") %>%
filter(year %in% c(1961, 1971, 1981, 1991, 2001, 2011, 2021)) %>%
ggplot(aes(gnppcap, fill = factor(year))) + geom_density(alpha = 0.4) + scale_x_log10()
df_gnppcap %>% drop_na(gnppcap) %>% filter(region  != "Aggregates") %>%
filter(year %in% c(1971, 1981, 1991, 2001, 2011, 2021)) %>%
ggplot(aes(gnppcap, fill = factor(year))) +
geom_density() + scale_x_log10() + facet_wrap(~year)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(region) %>% filter(year %in% c(2021)) %>%
ggplot(aes(gnppcap, region, fill = region)) +
geom_boxplot() + scale_x_log10() + labs(y = "") +
theme(legend.position = "none")
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(gnppcap, level, fill = income)) +
geom_boxplot() + scale_x_log10() + labs(y = "") +
theme(legend.position = "none")
library(maps)
gnppcap_short <- df_gnppcap %>% filter(year == 2021, region != "Aggregates") %>%
select(iso2c, gnppcap, income)
map_world <- map_data('world')
map_gnppcap <- map_world %>%
mutate(iso2c = iso.alpha(region, n=2)) %>%
left_join(gnppcap_short, by = "iso2c")
head(map_gnppcap)
map_gnppcap %>% mutate(income_level = factor(income, levels = c("High income", "Upper middle income", "Lower middle income", "Low income", "Not classified", NA))) %>%
ggplot() +
geom_map(aes(long, lat, map_id = region, fill = income_level), map = map_world, col = "black", size = 0.1)
map_gnppcap %>%
ggplot() +
geom_map(aes(x=long, y=lat, map_id = region, fill = gnppcap), map = map_world, col = "black", size = 0.1)
df_gnppcap <- WDI(country = "all",
indicator = c(gnppcap = "NY.GNP.PCAP.CD"),
extra = TRUE)
head(df_gnppcap)
str(df_gnppcap)
summary(df_gnppcap)
df_gnppcap %>% distinct(country) %>% pull()
View(df_gnppcap)
df_gnppcap %>% distinct(country, iso2c)
df_gnppcap %>% filter(region != "Aggregates") %>% distinct(country, iso2c)
df_gnppcap %>% filter(region == "Aggregates") %>% distinct(country, iso2c)
df_gnppcap %>% filter(country == "Japan") %>% head()
df_gnppcap %>% filter(country == "Japan") %>%
ggplot(aes(x = year, y = gnppcap)) + geom_line()
Sys.setenv(LANG = "en")
library(tidyverse)
library(WDI)
df_gnppcap <- WDI(country = "all",
indicator = c(gnppcap = "NY.GNP.PCAP.CD"),
extra = TRUE)
head(df_gnppcap)
str(df_gnppcap)
summary(df_gnppcap)
df_gnppcap %>% filter(region != "Aggregates") %>% distinct(country, iso2c)
df_gnppcap %>% filter(region == "Aggregates") %>% distinct(country, iso2c)
df_gnppcap %>% filter(country == "Japan") %>% head()
df_gnppcap %>% filter(country == "Japan") %>%
ggplot(aes(x = year, y = gnppcap)) + geom_line()
df_gnppcap %>% drop_na(gnppcap) %>% ggplot(aes(x = year)) + geom_bar()
df_gnppcap %>% filter(year == 2021) %>% drop_na(gnppcap) %>%
arrange(desc(gnppcap))
df_gnppcap %>% filter(year == 2021, region == "Aggregates") %>%
drop_na(gnppcap) %>% arrange(gnppcap)
df_gnppcap %>% filter(iso2c %in% c("US", "CN", "JP", "DE", "IN", "GB", "FR")) %>%
ggplot(aes(x = year, y = gnppcap, col = iso2c)) + geom_line()
df_gnppcap %>% filter(iso2c %in% c("XE", "XL", "XI", "XH","XQ","XO", "XP", "XF", "XJ")) %>%
ggplot(aes(x = year, y = gnppcap, col = iso2c)) + geom_line()
df_gnppcap %>% drop_na(gnppcap) %>%
filter(year == 2021) %>% filter(region  != "Aggregates") %>%
ggplot(aes(gnppcap)) + geom_histogram()
df_gnppcap %>% drop_na(gnppcap) %>%
filter(year == 2021) %>% filter(region  != "Aggregates") %>%
ggplot(aes(gnppcap)) + geom_histogram() + scale_x_log10()
df_gnppcap %>% drop_na(gnppcap) %>%
filter(year == 2021) %>% filter(region  != "Aggregates") %>%
ggplot(aes(gnppcap)) + geom_density()
df_gnppcap %>% drop_na(gnppcap) %>%
filter(year == 2021) %>% filter(region  != "Aggregates") %>%
ggplot(aes(gnppcap)) + geom_density() + scale_x_log10()
df_gnppcap %>% drop_na(gnppcap) %>% filter(region  != "Aggregates") %>%
filter(year %in% c(1961, 1971, 1981, 1991, 2001, 2011, 2021)) %>%
ggplot(aes(gnppcap, fill = factor(year))) + geom_density(alpha = 0.4)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region  != "Aggregates") %>%
filter(year %in% c(1961, 1971, 1981, 1991, 2001, 2011, 2021)) %>%
ggplot(aes(gnppcap, fill = factor(year))) + geom_density(alpha = 0.4) + scale_x_log10()
df_gnppcap %>% drop_na(gnppcap) %>% filter(region  != "Aggregates") %>%
filter(year %in% c(1971, 1981, 1991, 2001, 2011, 2021)) %>%
ggplot(aes(gnppcap, fill = factor(year))) +
geom_density() + scale_x_log10() + facet_wrap(~year)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(region) %>% filter(year %in% c(2021)) %>%
ggplot(aes(gnppcap, region, fill = region)) +
geom_boxplot() + scale_x_log10() + labs(y = "") +
theme(legend.position = "none")
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(gnppcap, level, fill = income)) +
geom_boxplot() + scale_x_log10() + labs(y = "") +
theme(legend.position = "none")
library(maps)
gnppcap_short <- df_gnppcap %>% filter(year == 2021, region != "Aggregates") %>%
select(iso2c, gnppcap, income)
map_world <- map_data('world')
map_gnppcap <- map_world %>%
mutate(iso2c = iso.alpha(region, n=2)) %>%
left_join(gnppcap_short, by = "iso2c")
head(map_gnppcap)
map_gnppcap %>% mutate(income_level = factor(income, levels = c("High income", "Upper middle income", "Lower middle income", "Low income", "Not classified", NA))) %>%
ggplot() +
geom_map(aes(long, lat, map_id = region, fill = income_level), map = map_world, col = "black", size = 0.1)
map_gnppcap %>%
ggplot() +
geom_map(aes(x=long, y=lat, map_id = region, fill = gnppcap), map = map_world, col = "black", size = 0.1)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(n = n()) %>%
ggplot(aes(x = year, y = n, fill = income)) + geom_col()
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
ggplot(aes(x = year, y = number_of_countries, fill = income)) + geom_col()
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
ggplot(aes(x = year, y = number_of_countries, fill = income), col = "black") + geom_col()
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
ggplot(aes(x = year, y = number_of_countries, fill = income)) + geom_col(col = "black")
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
ggplot(aes(x = year, y = number_of_countries, fill = income)) + geom_col(col = "black", linewidth = 0.3)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
ggplot(aes(x = year, y = number_of_countries, fill = income)) + geom_col(col = "black", linewidth = 0.1)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
mutate(ratio = number_of_countries/sum(number_of_countries)) %>%
ggplot(aes(x = year, y = ratio, fill = income)) + geom_col(col = "black", linewidth = 0.1)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
ggplot(aes(x = year, y = number_of_countries, fill = income)) +
geom_col(col = "black", linewidth = 0.1)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
mutate(ratio = number_of_countries/sum(number_of_countries)) %>%
ggplot(aes(x = year, y = ratio, fill = income)) +
geom_col(col = "black", linewidth = 0.1)  +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
filter(income != "Not classified") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
mutate(ratio = number_of_countries/sum(number_of_countries)) %>%
ggplot(aes(x = year, y = ratio, fill = income)) +
geom_col(col = "black", linewidth = 0.1)  +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
filter(income != "Not classified") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
ggplot(aes(x = year, y = number_of_countries, fill = income)) +
geom_col(col = "black", linewidth = 0.1)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
filter(income != "Not classified") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(x = year, y = number_of_countries, fill = level)) +
geom_col(col = "black", linewidth = 0.1)
df_gnppcap %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
filter(income != "Not classified") %>%
group_by(year, income) %>% summarize(number_of_countries = n()) %>%
mutate(ratio = number_of_countries/sum(number_of_countries)) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(x = year, y = ratio, fill = income)) +
geom_col(col = "black", linewidth = 0.1)  +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))
df_gnppcap %>% filter(year == 2021, region != "Aggregates") %>%
drop_na(gnppcap) %>% arrange(desc(gnppcap))
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/first_ds_hw.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/first_ds_hw.Rmd")
View(df_gdp2)
pwd
getwd()
head(df_gdp)
write_csv(df_gdp, "./data/df_gdp.csv")
df <- df_gdp
# Subset data frame
df_subset <- df[df$year == 2021 & df$region != "Aggregates",]
# Select top 7 countries in GDP
top_7 <- df_subset[order(-df_subset$gdp),][1:7,]
# Create line graph
ggplot(top_7, aes(x = year, y = gdp, color = country)) +
geom_line()
Sys.setenv(LANG = "en")
library(tidyverse)
library(WDI)
WDIsearch(string = "gdp", field = "name", short = TRUE, cache = NULL)
WDIsearch(string = "military expenditure", field = "name", short = TRUE, cache = NULL)
WDIsearch(string = "NY.GDP.MKTP.CD", field = "indicator", short = TRUE, cache = NULL)
WDIsearch(string = "", field = "indicator", short = TRUE, cache = NULL)
wdi_cache <- read_rds("./data/wdi_cache.RData")
WDIsearch(string = "CPI Price", field = "name", short = FALSE, cache = NULL)
WDIsearch(string = "CPI Price", field = "name", short = FALSE, cache = wdi_cache)
WDIsearch(string = "NY.GDP.MKTP.KD.ZG", field = "indicator", short = FALSE, cache = wdi_cache)
df_gdp1 <- WDI(country = "all", indicator = "NY.GDP.MKTP.CD")
df_gdp1 %>% head()
df_gdp2 <- WDI(country = "all", indicator = c(gdp = "NY.GDP.MKTP.CD"))
df_gdp2 %>% head()
df_gdp3 <- WDI(country = "all", indicator = c(gdp = "NY.GDP.MKTP.CD"), extra=TRUE, cache=wdi_cache)
df_gdp3 %>% head()
df_gdp4 <- WDI(country = c("CN","GB","JP","IN","US","DE"), indicator = c(gdp = "NY.GDP.MKTP.CD"), extra=TRUE, cache=wdi_cache)
df_gdp4 %>% head()
df_gdp21 <- WDI(country = "all",
indicator = c(gdp_deflator = "NY.GDP.DEFL.KD.ZG",
cpi_price = "CPTOTNSXN"),
extra=TRUE, cache=wdi_cache)
df_gdp21 %>% head()
str(df_gdp21)
summary(df_gdp21)
df_gdp4 %>% ggplot(aes(year, gdp, col=country)) + geom_line()
df_gdp4 %>% drop_na(gdp) %>%
ggplot(aes(year, gdp, col=country)) + geom_line() +
labs(title = paste("WDI - NY.GDP.MKTP.CD: ", "gdp"))
chosen_indicator <- "SL.UEM.TOTL.NE.ZS"
short_name <- "unemployment"
chosen_country <- "United States"
WDI(country = "all", indicator = c(short_name = chosen_indicator), extra=TRUE, cache=wdi_cache) %>%
filter(country == chosen_country) %>%
ggplot(aes(year, short_name)) + geom_line() +
labs(title = paste("WDI ", chosen_indicator, ": ", short_name, " - ", chosen_country),
y = short_name)
chosen_indicator <- "SL.UEM.TOTL.NE.ZS"
chosen_country <- "United States"
WDI(country = "all", indicator = c(chosen_indicator = chosen_indicator),
extra=TRUE, cache=wdi_cache) %>%
filter(country == chosen_country) %>%
ggplot(aes(year, chosen_indicator)) + geom_line() +
labs(title = paste("WDI ", chosen_indicator, " - ", chosen_country),
y = chosen_indicator)
chosen_indicator <- "SL.UEM.TOTL.NE.ZS"
short_name <- "unemployment"
chosen_countries <- c("United States","United Kingdom", "Japan")
WDI(country = "all", indicator = c(short_name = chosen_indicator), extra=TRUE, cache=wdi_cache) %>% drop_na(short_name) %>%
filter(country %in% chosen_countries) %>%
ggplot(aes(year, short_name, col = country)) + geom_line() +
labs(title = paste("WDI ", chosen_indicator, ": ", short_name), y = short_name)
chosen_indicator_1 <- "NY.GDP.DEFL.KD.ZG"
short_name_1 <- "gdp_deflator"
chosen_indicator_2 <- "CPTOTSAXNZGY"
short_name_2 <- "cpi_price"
chosen_country <- "United States"
WDI(country = "all", indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2), extra=TRUE, cache=wdi_cache) %>%
filter(country == chosen_country) %>%
pivot_longer(c(short_name_1, short_name_2), names_to = "class", values_to = "value") %>% drop_na(value) %>%
ggplot(aes(year, value, col = class)) + geom_line() +
labs(title = paste("WDI ", chosen_indicator_1, ": ", short_name_1, "\n", chosen_indicator_2, ": ", short_name_2, " - ", chosen_country)) +
scale_color_manual(labels = c(short_name_1, short_name_2), values = scales::hue_pal()(2))
chosen_indicator_1 <- "SL.TLF.CACT.MA.NE.ZS"
short_name_1 <- "male"
chosen_indicator_2 <- "SL.TLF.CACT.FE.NE.ZS"
short_name_2 <- "female"
chosen_country <- "United States"
WDI(country = "all", indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2), extra=TRUE, cache=wdi_cache) %>%
filter(country == chosen_country) %>%
pivot_longer(c(short_name_1, short_name_2), names_to = "class", values_to = "value") %>% drop_na(value) %>%
ggplot(aes(year, value, col = class)) + geom_line() +
labs(title = paste("WDI ", chosen_indicator_1, ": ", short_name_1, "\n", chosen_indicator_2, ": ", short_name_2, " - ", chosen_country)) +
scale_color_manual(labels = c(short_name_1, short_name_2), values = scales::hue_pal()(2))
chosen_indicator_1 <- "NY.GDP.DEFL.KD.ZG"
short_name_1 <- "gdp_deflator"
chosen_indicator_2 <- "CPTOTSAXNZGY"
short_name_2 <- "cpi_price"
chosen_countries <- c("United States", "France", "Japan")
WDI(country = "all", indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2), extra=TRUE, cache=wdi_cache) %>%
filter(country %in% chosen_countries) %>%
pivot_longer(c(short_name_1, short_name_2), names_to = "class", values_to = "value") %>% drop_na(value) %>%
ggplot(aes(year, value, linetype = class, col = country)) + geom_line() +
labs(title = paste("WDI ", chosen_indicator_1, ": ", short_name_1, "\n", chosen_indicator_2, ": ", short_name_2)) +
scale_linetype_manual(labels = c(short_name_1, short_name_2), values = c("solid", "dashed"))
chosen_indicator_1 <- "SL.TLF.CACT.MA.NE.ZS"
short_name_1 <- "male"
chosen_indicator_2 <- "SL.TLF.CACT.FE.NE.ZS"
short_name_2 <- "female"
chosen_countries <- c("United States", "France", "Japan")
WDI(country = "all", indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2), extra=TRUE, cache=wdi_cache) %>%
filter(country %in% chosen_countries) %>%
pivot_longer(c(short_name_1, short_name_2), names_to = "class", values_to = "value") %>% drop_na(value) %>%
ggplot(aes(year, value, linetype = class, col = country)) + geom_line() +
labs(title = paste("WDI ", chosen_indicator_1, ": ", short_name_1, "\n", chosen_indicator_2, ": ", short_name_2)) +
scale_linetype_manual(labels = c(short_name_1, short_name_2), values = c("solid", "dashed"))
gdp_data <- WDI::WDI(indicator = "NY.GDP.MKTP.CD", start = 2021, end = 2021)
# Create a histogram with ggplot2
ggplot(gdp_data, aes(x = NY.GDP.MKTP.CD)) +
geom_histogram(bins = 30, fill = "blue", color = "black") +
ggtitle("Distribution of GDP in 2021") +
xlab("GDP (current USD)") +
ylab("Count")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/first_ds.Rmd")
Sys.setenv(LANG = "en")
library(tidyverse)
library(WDI)
df <- WDI(country = "all",
indicator = c(gnppcap = "NY.GNP.PCAP.CD",
emission = "EN.ATM.CO2E.PC"),
extra = TRUE)
df
glimpse(df)
summary(df)
df %>% filter(region != "Aggregates") %>%
group_by(year) %>%
summarize(gnp_data = sum(!is.na(gnppcap)), co2_data = sum(!is.na(emission)))
df %>% filter(region != "Aggregates") %>%
group_by(year) %>%
summarize(gnp_data = sum(!is.na(gnppcap)), co2_data = sum(!is.na(emission))) %>%
pivot_longer(-year, names_to = "type", values_to = "value") %>%
ggplot(aes(year, value, col = type)) + geom_line()
df %>% distinct(region) %>% pull()
df %>% filter(is.na(region)) %>% distinct(country) %>% pull()
df %>% filter(is.na(income) | income == "Not classified") %>% distinct(country) %>% pull()
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(gnppcap, level, fill = income)) +
geom_boxplot() + scale_x_log10() + labs(y = "") +
theme(legend.position = "none") +
labs(title = "Boxplot of GNI per Capita by Income Level")
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
group_by(level) %>%
summarize(max = max(gnppcap), median = median(gnppcap), mean = mean(gnppcap), min = min(gnppcap), n = n())
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Upper middle income", gnppcap < 5110)
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Lower middle income", gnppcap > 4170)
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income", gnppcap == min(gnppcap))
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(region) %>% filter(year %in% c(2021)) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(gnppcap, region, fill = region)) +
geom_boxplot() + scale_x_log10() + labs(y = "") +
theme(legend.position = "none") +
labs(title = "Boxplot of GNI per Capita by Region")
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(region) %>% filter(year %in% c(2021)) %>%
group_by(region) %>%
summarize(max = max(gnppcap), median = median(gnppcap), mean = mean(gnppcap), min = min(gnppcap), n = n())
df %>% drop_na(emission) %>% filter(region != "Aggregates", income !="Not classified") %>%
drop_na(income) %>% filter(year %in% c(2019)) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(emission, level, fill = income)) +
geom_boxplot() + labs(y = "") +
theme(legend.position = "none") +
labs(title = "Boxplot of CO2 Emission Capita by Income Level")
df %>% drop_na(emission) %>%
filter(region != "Aggregates", income != "Not classified") %>%
drop_na(income) %>% filter(year %in% c(2019)) %>%
mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
group_by(level) %>%
summarize(max = max(emission), median = median(emission), iqr = IQR(emission), n = n())
df %>% drop_na(emission) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2019)) %>%
filter(income == "High income") %>%
filter(emission > median(emission) + 1.5*IQR(emission)) %>%
arrange(desc(emission))
df %>% drop_na(emission) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2019)) %>%
filter(income == "Upper middle income") %>%
filter(emission > median(emission) + 1.5*IQR(emission)) %>%
arrange(desc(emission))
df %>% drop_na(emission) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2019)) %>%
filter(income == "Lower middle income") %>%
filter(emission > median(emission) + 1.5*IQR(emission)) %>%
arrange(desc(emission))
df %>% drop_na(emission) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2019)) %>%
filter(income == "Low income") %>%
filter(emission > median(emission) + 1.5*IQR(emission))
df %>% filter(country == "World") %>% drop_na(gnppcap) %>%
ggplot(aes(year, gnppcap)) + geom_line() +
labs(title = "GNI per Capita of the World")
df %>% filter(country == "World") %>% drop_na(emission) %>%
ggplot(aes(year, emission)) + geom_line() +
labs(title = "CO2 emissions per Capita of the World")
df %>% filter(country == "World") %>% drop_na(gnppcap) %>%
ggplot(aes(year, gnppcap)) + geom_line() +
geom_smooth(method = "lm", formular = y~x, se = FALSE) +
labs(title = "GNI per Capita of the World", subtitle = "with a regression line")
df %>% filter(country == "World") %>% drop_na(gnppcap) %>%
lm(gnppcap ~ year, .) %>% summary()
df %>% filter(country == "World") %>% drop_na(emission) %>%
ggplot(aes(year, emission)) + geom_line() +
geom_smooth(method = "lm", formular = y~x, se = FALSE)  +
labs(title = "CO2 emissions per Capita of the World", subtitle = "with a regression line")
df %>% filter(country == "World") %>% drop_na(emission) %>%
lm(emission ~ year, .) %>% summary()
df %>% filter(country == "Japan") %>% drop_na(gnppcap) %>%
ggplot(aes(year, gnppcap)) + geom_line() +
labs(title = "GNI per Capita of Japan")
df %>% filter(country == "Japan") %>% drop_na(emission) %>%
ggplot(aes(year, emission)) + geom_line() +
labs(title = "CO2 emissions per Capita of Japan")
df %>% filter(iso2c %in% c("US", "CN", "JP", "DE", "IN", "GB", "FR")) %>%
ggplot(aes(x = year, y = gnppcap, col = iso2c)) + geom_line() +
labs(title = "GNI per Capita of Top GDP countries")
df %>% filter(iso2c %in% c("US", "CN", "JP", "DE", "IN", "GB", "FR")) %>%
drop_na(emission) %>%
ggplot(aes(x = year, y = emission, col = iso2c)) + geom_line() +
labs(title = "CO2 Emissions per Capita of Top GDP countries")
df %>% filter(region != "Aggregates", income != "Not classified") %>% drop_na(gnppcap, income) %>%  mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(year, gnppcap, color = level)) + geom_smooth(se = FALSE) +
labs(title = "GNI per Capita by Income Level")
df %>% filter(region != "Aggregates", income != "Not classified") %>% drop_na(emission, income) %>%  mutate(level = factor(income, c("High income", "Upper middle income", "Lower middle income", "Low income"))) %>%
ggplot(aes(year, emission, color = level)) + geom_smooth(se = FALSE) +
labs(title = "CO2 Emissions per Capita by Income Level")
df %>% filter(region != "Aggregates", year == 2019) %>%
drop_na(gnppcap, emission) %>%
ggplot(aes(gnppcap, emission, col = income)) + geom_point() + scale_x_log10()
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income") %>%
filter(gnppcap < median(gnppcap) - 1.5*IQR(gnppcap))
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income") %>%
filter(gnppcap <= median(gnppcap) - 1.5*IQR(gnppcap))
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income")
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income") %>% median(gnppcap) - 1.5*IQR(gnppcap)
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income") %>% arrange(gnppcap)
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income") %>% summarize(median = median(gnppercap), iqr = IQR(gnppercap), min = min(gnppercap))
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income") %>% summarize(median = median(gnppcap), iqr = IQR(gnppcap), min = min(gnppcap))
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income") %>%
filter(gnppcap < median(gnppcap) - 1.5*IQR(log10(gnppcap)))
df %>% drop_na(gnppcap) %>% filter(region != "Aggregates") %>%
drop_na(income) %>% filter(year %in% c(2021)) %>%
filter(income == "Low income") %>%
filter(log10(gnppcap) < median(log10(gnppcap)) - 1.5*IQR(log10(gnppcap)))
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/docs/eco101_resp.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
library(tidyverse)
url_school_jp <- "https://www.gender.go.jp/about_danjo/whitepaper/r02/zentai/html/honpen/csv/zuhyo01-04-01.csv"
df_school_jp <- read_csv(url_school_jp, locale = locale(encoding = "Shift_JIS"), skip=2)
df_edu0 <- df_school_jp
colnames(df_edu0) <- c("year", "highschool_m", "highschool_f", "vocational_m", "vocational_f", "university_m", "university_f", "juniorcollege_f", "gradschool_m", "gradschool_f")
df_edu00 <- df_edu0 %>% mutate(year = 1950:2019,
highschool = (highschool_m + highschool_f)/2,
vocational = (vocational_m + vocational_f)/2,
university = (university_m + university_f)/2,
juniorcollege = juniorcollege_f,
gradschool = (gradschool_m + gradschool_f)/2)
df_edu00 %>% filter(year >= 1954) %>% select(-(2:10)) %>%
pivot_longer(3:5, names_to = "schools", values_to = "percentage") %>%
mutate(types = factor(schools, levels = c("vocational", "juniorcollege", "university"))) %>%
pivot_longer(c(highschool, gradschool), names_to = "highgrad", values_to ="value") %>%
mutate(high_grad = factor(highgrad, levels = c("highschool", "gradschool"))) %>%
ggplot() +
geom_area(aes(x = year, y = percentage, fill = types)) +
geom_line(aes(x = year, y = value, linetype = high_grad)) +
scale_x_continuous(breaks = round(seq(1960, 2020, by =10),1)) +
scale_y_continuous(breaks = round(seq(0, 100, by =10),1)) +
labs(title = "Tertially Education After Highschool",
subtitle = "with Highschool Graduates and Graduate School",
fill = "", linetype = "")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
source("~/Documents/_class/gsclasses/intro_R/intro2r/rims2023/ds-ed_2023.Rmd")
plot(cars)
