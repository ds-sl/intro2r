# Print the default values
print(default_fig_width)
print(default_fig_height)
df_gini <- WDI(indicator = c(gini = "SI.POV.GINI",
`0-20` = "SI.DST.FRST.20",
`20-40` = "SI.DST.02ND.20",
`40-60` = "SI.DST.03RD.20",
`60-80` = "SI.DST.04TH.20",
`80-100` = "SI.DST.05TH.20"))
df_gini <- read_csv("data/gini.csv")
write_csv(df_gini, "data/gini.csv")
df_gini <- read_csv("data/gini.csv")
df_gini
df_gini <- df_gini |> mutate(`s80/s20` = `80-100`/`0-20`)
df_gini
df_gini |> drop_na(gini, `0-20`, `80-100`) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(year)) + geom_bar()
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
filter(!(iso2c %in% REGION)) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
filter(!(iso2c %in% REGION)) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |> filter(year == 2018) |>
filter(!(iso2c %in% REGION)) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`80-100`, gini)) + geom_point() + geom_smooth(formula = 'y~x', method = "lm", se = FALSE)
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`s80/s20`, gini)) + geom_point() + geom_smooth(formula = 'y~x', method = "lm", se = FALSE)
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`s80/s20`, `80-100`)) + geom_point() + geom_smooth(formula = 'y~x', method = "lm", se = FALSE)
model_gini_top20 <- df_gini |> lm(gini ~ `80-100`, data = _)
model_gini_top20 <- df_gini |> lm(gini ~ `80-100`, data = _)
model_gini_8020 <- df_gini |> lm(gini ~ `s80/s20`, data = _)
model_8020_top20 <- df_gini |> lm(`s80/s20` ~ `80-100`, data = _)
glance(model_gini_top10)
library(tidyverse)
library(broom)
library(WDI)
library(DescTools)
glance(model_gini_top10)
model_gini_top20 <- df_gini |> lm(gini ~ `80-100`, data = _)
model_gini_8020 <- df_gini |> lm(gini ~ `s80/s20`, data = _)
model_8020_top20 <- df_gini |> lm(`s80/s20` ~ `80-100`, data = _)
glance(model_gini_top10)
glance(model_gini_top10)
glance(model_gini_top20)
glance(model_gini_top20) |> rbind(glance(model_gini_8020))
glance(model_gini_top20) |> rbind(glance(model_gini_8020)) |> rbind(glance(model_8020_top20))
tidy(model_gini_top20) |> rbind(tidy(model_gini_8020)) |> rbind(tidy(model_8020_top20))
model_gini_top20 |> summary()
model_gini_8020 |> summary()
model_8020_top20 |> summary()
df_gini <- df_gini |> mutate(`s80/s20` = `80-100`/`0-20`)
df_gini
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(year)) + geom_bar()
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`80-100`, gini)) + geom_point() + geom_smooth(formula = 'y~x', method = "lm", se = FALSE) + labs(title = "Scatter plot of top 20 % vs gini")
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`s80/s20`, gini)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "Scatter plot of s80/s20 ratio vs gini")
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`s80/s20`, `80-100`)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "Scatter plot of s80/s20 ratio vs top 20 %")
library(tidyverse)
library(broom)
library(WDI)
library(DescTools)
df_gini <- read_csv("data/gini.csv")
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_gini
df_gini <- df_gini |> mutate(`s80/s20` = `80-100`/`0-20`)
df_gini
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(year)) + geom_bar()
df_gini |> drop_na(gini, `0-20`, `80-100`) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
filter(!(iso2c %in% REGION)) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |> filter(year == 2018) |>
filter(!(iso2c %in% REGION)) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`80-100`, gini)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "Scatter plot of top 20 % vs gini")
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`s80/s20`, gini)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "Scatter plot of s80/s20 ratio vs gini")
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`s80/s20`, `80-100`)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "Scatter plot of s80/s20 ratio vs top 20 %")
model_gini_top20 <- df_gini |> lm(gini ~ `80-100`, data = _)
model_gini_8020 <- df_gini |> lm(gini ~ `s80/s20`, data = _)
model_8020_top20 <- df_gini |> lm(`s80/s20` ~ `80-100`, data = _)
model_gini_top20 |> summary()
model_gini_8020 |> summary()
model_8020_top20 |> summary()
tidy(model_gini_top20) |> rbind(tidy(model_gini_8020)) |> rbind(tidy(model_8020_top20))
glance(model_gini_top20) |> rbind(glance(model_gini_8020)) |> rbind(glance(model_8020_top20))
df_gini_calc <- df_gini |>
mutate(`0` = 0, `20` = `0-20`,
`40` = `0-20` + `20-40`,
`60` = `0-20` + `20-40` + `40-60`,
`80` = `0-20` + `20-40` + `40-60` + `60-80`,
`100` = 100) |>
select(-c(`0-20`:`80-100`))
df_gini_calc %>% drop_na()
df_gini_calc_long <- df_gini_calc |>  pivot_longer(`0`:`100`, names_to = "classes", values_to = "cumulative_share") |> mutate(classes = as.numeric(classes))
df_gini_calc_long %>% drop_na()
df_gini_calc_long |> group_by(country, year) |>
drop_na(gini) |>
reframe(gini, gini_spline = round(100-AUC(classes, cumulative_share, method = "spline")/50, digits = 1), gini_trapezoid = round(100-AUC(classes, cumulative_share)/50, digits = 1)) |>
distinct(country, year, gini, gini_spline, gini_trapezoid)
df_gini_calc <- df_gini |>
mutate(`0` = 0, `20` = `0-20`,
`40` = `0-20` + `20-40`,
`60` = `0-20` + `20-40` + `40-60`,
`80` = `0-20` + `20-40` + `40-60` + `60-80`,
`100` = 100) |>
select(-c(`0-20`:`60-80`))
df_gini_calc %>% drop_na()
df_gini_calc_long <- df_gini_calc |>  pivot_longer(`0`:`100`, names_to = "classes", values_to = "cumulative_share") |> mutate(classes = as.numeric(classes))
df_gini_calc_long %>% drop_na()
df_gini_calc_long |> group_by(country, year) |>
drop_na(gini) |>
reframe(gini, gini_spline = round(100-AUC(classes, cumulative_share, method = "spline")/50, digits = 1), gini_trapezoid = round(100-AUC(classes, cumulative_share)/50, digits = 1)) |>
distinct(country, year, gini, gini_spline, gini_trapezoid)
df_gini_calc_long |> group_by(country, year) |>
drop_na(gini) |>
reframe(gini, gini_spline = round(100-AUC(classes, cumulative_share, method = "spline")/50, digits = 1), gini_trapezoid = round(100-AUC(classes, cumulative_share)/50, digits = 1))
df_gini_calc_long |> group_by(country, year) |>
drop_na(gini) |>
reframe(gini, gini_spline = round(100-AUC(classes, cumulative_share, method = "spline")/50, digits = 1), gini_trapezoid = round(100-AUC(classes, cumulative_share)/50, digits = 1), `80-100`, `s80/s20`) |>
distinct(country, year, gini, gini_spline, gini_trapezoid, `80-100`, `s80/s20`)
df_gini_f <- df_gini_calc_long |> group_by(country, year) |>
drop_na(gini) |>
reframe(gini, gini_spline = round(100-AUC(classes, cumulative_share, method = "spline")/50, digits = 1), gini_trapezoid = round(100-AUC(classes, cumulative_share)/50, digits = 1), `80-100`, `s80/s20`) |>
distinct(country, year, gini, gini_spline, gini_trapezoid, `80-100`, `s80/s20`)
df_gini_f
df_gini_f |> select(gini, gini_spline, gini_trapezoid, `80-100`, `s80/s20`) |> cor() |> as.data.frame()
df_gini_f |> drop_na(gini, gini_spline, gini_trapezoid, `80-100`, `s80/s20`) |> select(gini, gini_spline, gini_trapezoid, `80-100`, `s80/s20`) |> cor() |> as.data.frame()
GINI <- function(x){
Lc(x)[c(1,2)] |> as.tibble() |> mutate(A = p, .after = 1) |>
pivot_longer(-1, names_to = "name", values_to = "value") |>
ggplot(aes(p, value, fill = name)) +
geom_area(position = "identity") +
annotate("text", x = 0.25, y = 0.75, label = paste("GINI = A/(A+L) = ", round(Gini(x, unbiased = FALSE), digits = 2))) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(title = "GINI Index", x = "People", y = "Wealth", fill = "")}
x <- c(0,1)
GINI(x)
y <- c(1,2,3,4,5,6,7,8,9,10)
GINI(y)
z <- c(1/12,3/12,6/12,9/12,1)
GINI(z)
df_gini_long <- df_gini |>
pivot_longer(`0-20`:`80-100`)
df_gini_long
df_gini <- read_csv("data/gini.csv")
df_gini_long <- df_gini |>
pivot_longer(`0-20`:`80-100`)
df_gini_long
df_gini_long |> filter(year == 2022) |>
filter(levels != "gini") |>  drop_na(value) |>
ggplot(aes(levels, value)) + geom_col() + facet_wrap(~country)
df_gini_long |> filter(year == 2022) |>
filter(name != "gini") |>  drop_na(value) |>
ggplot(aes(levels, value)) + geom_col() + facet_wrap(~country)
df_gini_long |> filter(year == 2022) |>
filter(name != "gini") |>  drop_na(value) |>
ggplot(aes(name, value)) + geom_col() + facet_wrap(~country)
COUNTRIES_GINI <- c("Bhutan", "Bangladesh","Indonesia","Costa Rica")
YEAR_GINI <- 2022
df_gini_long |>
filter(country %in% COUNTRIES_GINI, year == YEAR_GINI) |>
ggplot(aes(name, value, fill = factor(country, levels = COUNTRIES_GINI))) + geom_col(position = "dodge") + labs(fill = "")
df_gini_calc_long |> filter(year == 2022) |> drop_na(gini) |>
ggplot() +
geom_line(aes(classes, cumulative_share, col = country)) +
geom_segment(aes(x = 0, y = 0, xend = 100, yend = 100, col = country), color = 'red') +
scale_x_continuous(breaks = seq(0,100,by=20)) +
scale_y_continuous(breaks = seq(0,100,by=20)) +
labs(col = "From gini top")
df_gini_calc_long |> filter(year == 2022) |> drop_na(gini) |>
ggplot() +
geom_line(aes(classes, cumulative_share, col = country)) +
geom_segment(aes(x = 0, y = 0, xend = 100, yend = 100, col = country), color = 'red') +
scale_x_continuous(breaks = seq(0,100,by=20)) +
scale_y_continuous(breaks = seq(0,100,by=20)) +
labs(col = "Seven Countries with Data in 2022")
df_gini_calc_long |> filter(year == 2022) |> drop_na(gini) |>
ggplot() +
geom_line(aes(classes, cumulative_share, col = country)) +
geom_segment(aes(x = 0, y = 0, xend = 100, yend = 100, col = country), color = 'red') +
scale_x_continuous(breaks = seq(0,100,by=20)) +
scale_y_continuous(breaks = seq(0,100,by=20)) +
labs(title = "Lorenz Curve of Seven Countries with Data in 2022", col = "countries")
library(tidyverse)
library(broom)
library(WDI)
library(DescTools)
GINI <- function(x){
Lc(x)[c(1,2)] |> as.tibble() |> mutate(A = p, .after = 1) |>
pivot_longer(-1, names_to = "name", values_to = "value") |>
ggplot(aes(p, value, fill = name)) +
geom_area(position = "identity") +
annotate("text", x = 0.25, y = 0.75, label = paste("GINI = A/(A+L) = ", round(Gini(x, unbiased = FALSE), digits = 2))) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1))+
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(title = "GINI Index", x = "People", y = "Wealth", fill = "")}
x <- c(0,1)
GINI(x)
y <- c(1,2,3,4,5,6,7,8,9,10)
GINI(y)
z <- c(1/12,3/12,6/12,9/12,1)
GINI(z)
df_gini <- read_csv("data/gini.csv")
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5",
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6",
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1",
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2",
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD",
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP",
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI",
"ZJ", "ZQ", "ZT")
df_gini
df_gini_long <- df_gini |>
pivot_longer(`0-20`:`80-100`)
df_gini_long
df_gini_long |> filter(year == 2022) |>
filter(name != "gini") |>  drop_na(value) |>
ggplot(aes(name, value)) + geom_col() + facet_wrap(~country)
df_gini <- df_gini |> mutate(`s80/s20` = `80-100`/`0-20`)
df_gini
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(year)) + geom_bar()
df_gini |> drop_na(gini, `0-20`, `80-100`) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
filter(!(iso2c %in% REGION)) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |> filter(year == 2018) |>
filter(!(iso2c %in% REGION)) |> select(gini, `80-100`, `s80/s20`) |>
cor() |> as.data.frame()
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`80-100`, gini)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "Scatter plot of top 20 % vs gini")
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`s80/s20`, gini)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "Scatter plot of s80/s20 ratio vs gini")
df_gini |> drop_na(gini, `0-20`, `80-100`) |>
ggplot(aes(`s80/s20`, `80-100`)) + geom_point() +
geom_smooth(formula = 'y~x', method = "lm", se = FALSE) +
labs(title = "Scatter plot of s80/s20 ratio vs top 20 %")
model_gini_top20 <- df_gini |> lm(gini ~ `80-100`, data = _)
model_gini_8020 <- df_gini |> lm(gini ~ `s80/s20`, data = _)
model_8020_top20 <- df_gini |> lm(`s80/s20` ~ `80-100`, data = _)
model_gini_top20 |> summary()
model_gini_8020 |> summary()
model_8020_top20 |> summary()
tidy(model_gini_top20) |> rbind(tidy(model_gini_8020)) |> rbind(tidy(model_8020_top20))
glance(model_gini_top20) |> rbind(glance(model_gini_8020)) |> rbind(glance(model_8020_top20))
df_gini_calc <- df_gini |>
mutate(`0` = 0, `20` = `0-20`,
`40` = `0-20` + `20-40`,
`60` = `0-20` + `20-40` + `40-60`,
`80` = `0-20` + `20-40` + `40-60` + `60-80`,
`100` = 100) |>
select(-c(`0-20`:`60-80`))
df_gini_calc %>% drop_na()
df_gini_calc_long <- df_gini_calc |>  pivot_longer(`0`:`100`, names_to = "classes", values_to = "cumulative_share") |> mutate(classes = as.numeric(classes))
df_gini_calc_long %>% drop_na()
df_gini_f <- df_gini_calc_long |> group_by(country, year) |>
drop_na(gini) |>
reframe(gini, gini_spline = round(100-AUC(classes, cumulative_share, method = "spline")/50, digits = 1), gini_trapezoid = round(100-AUC(classes, cumulative_share)/50, digits = 1), `80-100`, `s80/s20`) |>
distinct(country, year, gini, gini_spline, gini_trapezoid, `80-100`, `s80/s20`)
df_gini_f
df_gini_f |> drop_na(gini, gini_spline, gini_trapezoid, `80-100`, `s80/s20`) |> select(gini, gini_spline, gini_trapezoid, `80-100`, `s80/s20`) |> cor() |> as.data.frame()
df_gini_calc_long |> filter(year == 2022) |> drop_na(gini) |>
ggplot() +
geom_line(aes(classes, cumulative_share, col = country)) +
geom_segment(aes(x = 0, y = 0, xend = 100, yend = 100, col = country), color = 'red') +
scale_x_continuous(breaks = seq(0,100,by=20)) +
scale_y_continuous(breaks = seq(0,100,by=20)) +
labs(title = "Lorenz Curves of Seven Countries with Data in 2022", col = "countries")
library(tidyverse)
df_ed_gov_exp <- read_csv("data/UNdata_Export_20240131_023355934.csv")
df_tertiary_ratio <- read_csv("data/UNdata_Export_20240131_023324053.csv")
df_ed_gov_exp
df_tertiary_ratio
df_ed_gov_exp |> str()
df_ed_gov_exp |> select(Subgroup, Year, Source, Unit, `Value Footnotes`) |> lapply(unique)
df_tertiary_ratio |> str()
df_ed_gov_exp <- read_csv("data/UNdata_Export_20240131_024758033.csv")
df_ed_gov_exp
df_tertiary_ratio <- ead_csv("docs/da4r/data/UNdata_Export_20240131_024820801.csv")
df_tertiary_ratio <- read_csv("docs/da4r/data/UNdata_Export_20240131_024820801.csv")
df_tertiary_ratio <- read_csv("data/UNdata_Export_20240131_024820801.csv")
df_tertiary_ratio
df_ed_gov_exp |> str()
df_ed_gov_exp |> select(`Time Period`, Sex, `Age group`, `Units of measurement`) |> lapply(unique)
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, year = as_integer(`Time Period`))
df_gov_exp <- df_ed_gov_exp |> select(-c(Sex, `Age group`, `Units of measurement`)) |>
mutate(iso3c = `Reference Area Code`, country = `Reference Area`, year = as_integer(`Time Period`))
library(tidyverse)
df_gov_exp <- df_ed_gov_exp |> select(-c(Sex, `Age group`, `Units of measurement`)) |>
mutate(iso3c = `Reference Area Code`, country = `Reference Area`, year = as.integer(`Time Period`))
df_gov_exp
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, year = as.integer(`Time Period`)) |> select(-c(Sex, `Age group`, `Units of measurement`)) |>
df_gov_exp
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, year = as.integer(`Time Period`)) |> select(-c(Sex, `Age group`, `Units of measurement`))
df_ed_gov_exp <- read_csv("data/UNdata_Export_20240131_024758033.csv")
df_ed_gov_exp
df_ed_gov_exp |> str()
df_ed_gov_exp |> select(`Time Period`, Sex, `Age group`, `Units of measurement`) |> lapply(unique)
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, year = as.integer(`Time Period`)) |> select(-c(Sex, `Age group`, `Units of measurement`))
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`) |> select(-c(Sex, `Age group`, `Units of measurement`))
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`) |> mutate(year = as.integer(`Time Period`))
df_gov_exp
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`) |> mutate(year = as.integer(`Time Period`)) |> select(-`Time Period`)
df_gov_exp
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`) |> mutate(year = as.integer(`Time Period`)) |>
select(-`Time Period`) |> arrange(iso3c, country, year)
df_gov_exp
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`) |> mutate(year = as.integer(`Time Period`)) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_tertiary_ratio |> str()
df_tertiary_ratio |> select(Subgroup, Year, Source, Unit, `Value Footnotes`) |> lapply(unique)
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`, gov_exp = `Observation Value`) |> mutate(year = as.integer(`Time Period`)) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`, gov_exp = `Observation Value`) |> mutate(year = as.integer(`Time Period`, .after = country)) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`, gov_exp = `Observation Value`) |> mutate(year = as.integer(`Time Period`, .before = gov_exp)) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_gov_exp <- df_ed_gov_exp |> select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`, gov_exp = `Observation Value`) |> mutate(year = as.integer(`Time Period`, .before = iso3c)) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_gov_exp <- df_ed_gov_exp |>
select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`, gov_exp = `Observation Value`) |> mutate(year = as.integer(`Time Period`, .before = 3)) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_gov_exp <- df_ed_gov_exp |>
select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`, gov_exp = `Observation Value`) |> mutate(year = as.integer(`Time Period`, .before = 2)) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_gov_exp <- df_ed_gov_exp |>
select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`, gov_exp = `Observation Value`) |> mutate(year = as.integer(`Time Period`), .after = country) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_tertiary <- df_tertiary_ratio |> select(un_code = `Country or Area Code`, country = `Country or Area`, sex = Subgroup, year = Year, tertiary = Value) |> mutate(year = as.integer(year), .before = sex)
df_tertiary
df_tertiary <- df_tertiary_ratio |> select(un_code = `Country or Area Code`, country = `Country or Area`, sex = Subgroup, Year, tertiary = Value) |> mutate(year = as.integer(Year), .before = sex)
df_tertiary
df_tertiary <- df_tertiary_ratio |> select(un_code = `Country or Area Code`, country = `Country or Area`, sex = Subgroup, Year, tertiary = Value) |> mutate(year = as.integer(Year), .before = sex) |> select(-Year)
df_tertiary
View(df_tertiary)
setdiff(unique(df_gov_exp$country), unique(df_tertiary$country))
setdiff(unique(df_tertiary$country), unique(df_gov_exp$country))
df_tertiary |> mutate(iso3c = countrycode(un_code, "un", "iso3c"), .after = un_code)
df_tertiary |> mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code)
df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
drop_na(iso3c) |> distinct(country)
df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
filter(is.na(iso3c)) |> distinct(country)
df_gov_exp$country |> filter(country %in% c("Netherlands Antilles", "Serbia and Montenegro"))
df_gov_exp |> filter(country %in% c("Netherlands Antilles", "Serbia and Montenegro"))
df_tertiary1 <- df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
select(-country, un_code)
df_tertiary1
df_tertiary1 <- df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
select(-country, -un_code)
df_tertiary1
df_tertiary1 <- df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
select(-country, -un_code) |> filter(!is.na(iso3c))
df_tertiary1
df_un_ed_combined <- df_gov_exp |> full_join(df_tertiary1, by = c(iso3c, year))
df_un_ed_combined <- df_gov_exp |> full_join(df_tertiary1, by = c("iso3c", "year"))
df_un_ed_combined
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(gov_exp) |>
ggplot(aes(year, gov_exp, col = country)) + geom_line()
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(gov_exp) |>
ggplot(aes(year, gov_exp, col = country)) + geom_line() +
labs(title = "Five Countries' Goverment Expenditure on Education")
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line() +
labs(title = "Five Countries' Goverment Expenditure on Education")
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary)
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line()
df_tertiary <- df_tertiary_ratio |> select(un_code = `Country or Area Code`, country = `Country or Area`, sex = Subgroup, Year, tertiary = Value) |> mutate(year = as.integer(Year), .before = sex, tertiary = as.numeric(tertiary)) |> select(-Year)
df_tertiary
setdiff(unique(df_gov_exp$country), unique(df_tertiary$country))
setdiff(unique(df_tertiary$country), unique(df_gov_exp$country))
df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
filter(is.na(iso3c)) |> distinct(country)
df_gov_exp |> filter(country %in% c("Netherlands Antilles", "Serbia and Montenegro"))
df_tertiary1 <- df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
select(-country, -un_code) |> filter(!is.na(iso3c))
df_tertiary1
df_un_ed_combined <- df_gov_exp |> full_join(df_tertiary1, by = c("iso3c", "year"))
df_un_ed_combined
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(gov_exp) |>
ggplot(aes(year, gov_exp, col = country)) + geom_line() +
labs(title = "Five Countries' Goverment Expenditure on Education")
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary)
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line()
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line() + scale_y_log10()
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line() +
scale_y_log10() + labs(title = "Gross Enrollments in Tertiary Education")
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line() +
scale_y_log10() + labs(title = "Gross Enrolment Ratio in Tertiary Education")
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line() +
scale_y_log10() + labs(title = "Gross Enrolment Ratio in Tertiary Education", subtitle = "Log 10 Scale in Number")
library(tidyverse)
library(WDI)
library(readxl)
library(countrycode)
library(tidyverse)
wdicache <- read_rds("data/wdicache.rds")
df_ed_gov_exp <- read_csv("data/UNdata_Export_20240131_024758033.csv")
df_ed_gov_exp
df_ed_gov_exp |> str()
df_ed_gov_exp |> select(`Time Period`, Sex, `Age group`, `Units of measurement`) |> lapply(unique)
df_gov_exp <- df_ed_gov_exp |>
select(iso3c = `Reference Area Code`, country = `Reference Area`, `Time Period`, gov_exp = `Observation Value`) |> mutate(year = as.integer(`Time Period`), .after = country) |>
select(-`Time Period`) |> arrange(country, iso3c, year)
df_gov_exp
df_tertiary_ratio <- read_csv("data/UNdata_Export_20240131_024820801.csv")
df_tertiary_ratio
df_tertiary_ratio |> str()
df_tertiary_ratio |> select(Subgroup, Year, Source, Unit, `Value Footnotes`) |> lapply(unique)
df_tertiary <- df_tertiary_ratio |> select(un_code = `Country or Area Code`, country = `Country or Area`, sex = Subgroup, Year, tertiary = Value) |> mutate(year = as.integer(Year), .before = sex, tertiary = as.numeric(tertiary)) |> select(-Year)
df_tertiary
setdiff(unique(df_gov_exp$country), unique(df_tertiary$country))
setdiff(unique(df_tertiary$country), unique(df_gov_exp$country))
df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
filter(is.na(iso3c)) |> distinct(country)
df_gov_exp |> filter(country %in% c("Netherlands Antilles", "Serbia and Montenegro"))
df_tertiary1 <- df_tertiary |>
mutate(iso3c = countrycode(country, "country.name", "iso3c"), .after = un_code) |>
select(-country, -un_code) |> filter(!is.na(iso3c))
df_tertiary1
df_un_ed_combined <- df_gov_exp |> full_join(df_tertiary1, by = c("iso3c", "year"))
df_un_ed_combined
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(gov_exp) |>
ggplot(aes(year, gov_exp, col = country)) + geom_line() +
labs(title = "Five Countries' Goverment Expenditure on Education")
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary)
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line()
df_un_ed_combined |> filter(country %in% c("Japan", "Viet Nam", "China", "Republic of Korea", "United States of America")) |> drop_na(tertiary) |>
ggplot(aes(year, tertiary, col = country, linetype = sex)) + geom_line() +
scale_y_log10() + labs(title = "Gross Enrolment Ratio in Tertiary Education", subtitle = "Log 10 Scale in Number")
df_tertiary_ratio$Value |> unique()
wdicache <- read_rds("data/wdicache.rds")
df_un_ed_combined_ext <- df_un_ed_combined |> left_join(wdicache, by = 'iso3c')
df_un_ed_combined_ext <- df_un_ed_combined |> left_join(wdicache$country, by = 'iso3c')
df_un_ed_combined_ext <- df_un_ed_combined |> left_join(wdicache$country, by = 'iso3c')
df_un_ed_combined_ext <- df_un_ed_combined |> left_join(wdicache$country, by = 'iso3c')
df_un_ed_combined_ext
wdi_country_extra <- wdicache$country |> select(iso2c, iso3c, region, income, lending)
df_un_ed_combined_ext <- df_un_ed_combined |> left_join(wdi_country_extra, by = 'iso3c')
df_un_ed_combined_ext
wdi_country_extra <- wdicache$country |> select(iso3c, region, income, lending)
df_un_ed_combined_ext <- df_un_ed_combined |> left_join(wdi_country_extra, by = 'iso3c')
df_un_ed_combined_ext
rm(list = ls())
