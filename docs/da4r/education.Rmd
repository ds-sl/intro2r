---
title: "WDI Education"
author: "ID Last, First"
date: "`r Sys.Date()`"
output:
  html_notebook:
    number_sections: yes
    toc: yes
    toc_float: yes
---

# EDA using WDI

## Exploratory Data Analysis, EDA

EDA is an iterative cycle that helps you understand what your data says. When you do EDA, you:

1.  Generate questions about your data

2.  Search for answers by visualising, transforming, and/or modeling your data

3.  Use what you learn to refine your questions and/or generate new questions

EDA is an important part of any data analysis. You can use EDA to make discoveries about the world; or you can use EDA to ensure the quality of your data, asking questions about whether the data meets your standards or not. (Posit Primers: [EDA](https://posit.cloud/learn/primers/3.1))

## Workflow

1.  Importing data by WDI

```         
df_dataframe_name <- WDI(indicators = c(name1 = "Indicator Code 1", 
name2 = "Indicator Code 2"), extra = TRUE)
```

Write and read:

```         
write_csv(df_dataframe_name, "data/dataframe_name.csv")
df_dataframe_name <- read_csv("data/dataframe_name.csv")
```

2.  Viewing data by

`head()`, `str()`, `summary()`, and try `df_dataframe_name`. See also Environment Tab of RStudio.

3.  Transforming data by restricting the values of a variable.

```         
df_dataframe_name |> filter(var == "value") 
df_dataframe_name |> filter(var %in% c("value_1", ... , "value_n") 
df_dataframe_name |> filter(var != "value") 
df_dataframe_name |> drop_na(var)
```

-   Creating a new variable by mutation. (A little advanced. PCAP = gdp/pop)

```         
df_dataframe_name |> mutate(var_new = var1 * var2)}
```

4.  Change orders by `arrange()`

```         
df_dataframe_name |> arrange(var)
df_dataframe_name |> arrange(desc(var))
```

5.  Visualizing using ggplot() + geom\_\*()

    What type of **variation** occurs **within** my variables?

    What type of **covariation** occurs **between** my variables?

-   line graph

```         
transformed_data |> ggplot(aes(year, name1)) + geom_line()
transformed_data |> ggplot(aes(year, name2)) + geom_line()
```

-   scatterplot

```         
transformed_data |> ggplot(aes(name1, name2)) + geom_point()
transformed_data |> ggplot(aes(name1, name2)) + geom_point() + scale_x_log10()
```

-   scatterplot with a regression line

```         
transformed_data |> ggplot(aes(name1, name2)) + geom_point() +
  geom_smooth(method = "lm", se = FALSE)
transformed_data |> ggplot(aes(name1, name2)) + geom_point() + 
  geom_smooth(method = "lm", se = FALSE) + scale_x_log10()
```

-   histogram

```         
transformed_data |> ggplot(aes(name1)) + geom_histogram()
```

-   boxplot

`categorical_var`: `factor(year)`, `income`, `region`

```         
transformed_data |> ggplot(aes(categorical_var, name1)) + geom_boxplot()
```

6.  Do not forget to add your observations and questions.

## Setup

```{r}
library(tidyverse)
library(WDI)
```

### WDIcache() [[Link in da4r](https://icu-hsuzuki.github.io/da4r/wdidata.html?q=WDIcache#wdicache)]

If you have not download WDIcache recently, run the following two code chunks, otherwise start with the third.

```{r eval=FALSE}
wdicache <- WDIcache()
```

```{r eval=FALSE}
write_rds(wdicache, "data/wdicache.rds")
```

```{r eval=TRUE}
wdicache <- read_rds("data/wdicache.rds")
```

## Data

*List of data and its description*

1.  Government expenditure on education, total (% of GDP): SE.XPD.TOTL.GD.ZS [[Link](https://data.worldbank.org/indicator/SE.XPD.TOTL.GD.ZS)]
2.  School enrollment, primary (% gross): SE.PRM.ENRR [[Link](https://data.worldbank.org/indicator/SE.PRM.ENRR)]
3.  School enrollment, secondary (% gross): SE.SEC.ENRR [[Link](https://data.worldbank.org/indicator/SE.SEC.ENRR)]
4.  School enrollment, tertiary (% gross): SE.TER.ENRR [[Link](https://data.worldbank.org/indicator/SE.TER.ENRR)]

```{r}
WDIsearch(string = "SE.XPD.TOTL.GD.ZS", field = "indicator", short = FALSE, cache = wdicache)
```

### Importing Data

```{r cache = TRUE, eval = FALSE}
df_education <- WDI(
  indicator = c(expenditure = "SE.XPD.TOTL.GD.ZS",
                primary = "SE.PRM.ENRR",
                secondary = "SE.SEC.ENRR",
                tertiary = "SE.TER.ENRR"),
  extra = TRUE, cache = wdicache)
```

```{r eval = FALSE}
write_csv(df_education, "data/education.csv")
```

```{r}
df_education <- read_csv("data/education.csv")
```

### View Data

`head(df_education)` or `df_education` in R Notebook

```{r}
df_education
```

Structure of Data: `str(df_education)` or `glimpse(df_education)`

```{r}
str(df_education)
```

### Select Columns

```{r}
df_ed <- df_education |> select(country, iso2c, year, expenditure, primary, secondary, tertiary, region, income, lending)
df_ed
```

```{r}
df_ed |> filter(region == "Aggregates") |> distinct(country)
```

#### Check Data

```{r}
df_ed |> group_by(year) |> summarize(expenditure = sum(!is.na(expenditure)), 
                                     primary = sum(!is.na(primary)),
                                     secondary = sum(!is.na(secondary)),
                                     tertiary = sum(!is.na(tertiary))) |>
  arrange(desc(year))
```

### Visualization by Line Graphs

#### Government expenditure on education, total (% of GDP)

```{r}
df_ed |> filter(country == "Sub-Saharan Africa") |> drop_na(expenditure) |>
  ggplot(aes(year, expenditure)) + geom_line()
```

```{r}
df_ed |> drop_na(expenditure) |> filter(country %in% c("Arab World", "Africa Eastern and Southern", "Africa Western and Central", "Sub-Saharan Africa", "South Asia")) |> 
  ggplot(aes(year, expenditure, col = country)) + geom_line()
```

```{r}
df_ed |> filter(country == "Sub-Saharan Africa") |> drop_na(expenditure) |>
  ggplot(aes(year, primary)) + geom_line()
```

```{r}
df_ed |> filter(country == "Sub-Saharan Africa") |> drop_na(primary) |>
  ggplot() + geom_line(aes(year, primary), col = "red") + geom_line(aes(year, secondary), col = "blue") + geom_line(aes(year, tertiary)) + labs(title = "School Enrollment", y = "% gross")
```

### Long Table

```         
df |> pivot_longer(cols = c(columns to collect), names_to = "name", values_to = "value")
```

`primary:tertiary` from the column primary to the column tertiary

```{r}
df_ed_long <- df_ed |> pivot_longer(cols = primary:tertiary, names_to = "levels", values_to = "value") 
df_ed_long
```

#### Examples

Purchasing power parities (PPPs): [[R Notebook](https://ds-sl.github.io/intro2r/da4r/gdp_ppp.nb.html)], [[Rmd](https://github.com/ds-sl/intro2r/blob/main/docs/da4r/gdp_ppp.Rmd)]

```         
df_gdps_long <- df_gdps |> 
  pivot_longer(cols = c("gdp_nominal", "gdp_real", "gdp_ppp"),
               names_to = "gdp", values_to = "value")
```

```{r}
df_ed_long |> drop_na(value) |> 
  filter(country == "Sub-Saharan Africa") |>
  ggplot(aes(year, value, col = levels)) + geom_line()
```

```{r}
df_ed_long |> drop_na(value) |> 
  filter(country %in% c("Sub-Saharan Africa", "South Asia")) |>
  ggplot(aes(year, value, col = country, linetype = levels)) + geom_line()
```

## Choropleth Maps [[Link](https://icu-hsuzuki.github.io/da4r/worldmap.html#worldmap)]

Need map data and use `geom_sf`

### **Natural Earth Data**

[https://www.naturalearthdata.com](https://www.naturalearthdata.com/)

Get natural earth world country polygons

Manual: <https://cran.r-project.org/web/packages/rnaturalearth/rnaturalearth.pdf>

```{r}
library(rnaturalearth)
library(rnaturalearthdata)
```

```         
ne_countries(
  scale = 110,
  type = "countries",
  continent = NULL,
  country = NULL,
  geounit = NULL,
  sovereignty = NULL,
  returnclass = c("sp", "sf")
)
```

#### **Arguments**

-   scale: scale of map to return, one of 110, 50, 10 or ‘small’, ‘medium’, ‘large’

-   type: country type, one of ‘countries’, ‘map_units’, ‘sovereignty’, ‘tiny_countries’

-   continent: a character vector of continent names to get countries from.

-   country: a character vector of country names.

-   geounit: a character vector of geounit names.

-   sovereignty: a character vector of sovereignty names.

-   returnclass: ‘sp’ default or ‘sf’ for Simple Features

```{r}
ne_countries(scale = "medium", returnclass = "sf") %>%
  ggplot() +   geom_sf()
```

```{r}
ne_world <- ne_countries(scale = "medium", returnclass = "sf")
```

```{r}
str(ne_world)
```

```{r}
ne_world %>% ggplot() + geom_sf(aes(fill = region_wb))
```

```{r}
df_ed_2020 <- df_ed |> filter(year == 2020) |> select(iso2c, expenditure)
ne_ed_2020 <- ne_world |> left_join(df_ed_2020, by = c("wb_a2" = "iso2c"))
```

```{r}
ne_ed_2020 |> ggplot() + geom_sf(aes(fill = expenditure))
```

```{r}
ne_ed_2020 |> filter(subregion == "South-Eastern Asia") |> ggplot() + geom_sf(aes(fill = expenditure))
```

```{r}
df_ed_2020 |> drop_na(expenditure) |> pull() |> range()
```

```{r}
df_ed_2020 |> drop_na(expenditure) |> ggplot(aes(expenditure)) + geom_histogram(binwidth = 3) 
```

It is possible to use quantile.

```{r}
df_ed_2020 |> drop_na(expenditure) |> pull(expenditure) |> 
  quantile(probs = c(0.25,0.5,0.75,1))
```

```{r}
ne_ed_2020 |> mutate(level = cut(expenditure, breaks = c(0,3,6,9,20), labels = c("0-3","3-6","6-9","9-14"))) |> ggplot() + geom_sf(aes(fill = level)) + labs(title = "Government expenditure on education, total (% of GDP) in 2020")
```

```{r}
ne_ed_2020 |> filter(continent == "Africa") |> mutate(level = cut(expenditure, breaks = c(0,3,6,9,20), labels = c("0-3","3-6","6-9","9-14"))) |> ggplot() + geom_sf(aes(fill = level)) + labs(title = "Government expenditure on education, \ntotal (% of GDP) in 2020")
```

## School Enrollment vs GDP Per Capita

### Index Search

```{r}
WDIsearch(string = "school enrollment.*(% gross)", field = "name", short = FALSE)
```

1.  School enrollment, secondary (% gross): SE.SEC.ENRR

-   School enrollment, secondary (% gross) Gross enrollment ratio is the ratio of total enrollment, regardless of age, to the population of the age group that officially corresponds to the level of education shown. Secondary education completes the provision of basic education that began at the primary level, and aims at laying the foundations for lifelong learning and human development, by offering more subject- or skill-oriented instruction using more specialized teachers.

2.  School enrollment, tertiary (% gross): SE.TER.ENRR

-   Gross enrollment ratio is the ratio of total enrollment, regardless of age, to the population of the age group that officially corresponds to the level of education shown. Tertiary education, whether or not to an advanced research qualification, normally requires, as a minimum condition of admission, the successful completion of education at the secondary level.

3.  GDP per capita, PPP (constant 2017 international \$): NY.GDP.PCAP.PP.KD

-   GDP per capita, PPP (constant 2017 international \$) GDP per capita based on purchasing power parity (PPP). PPP GDP is gross domestic product converted to international dollars using purchasing power parity rates. An international dollar has the same purchasing power over GDP as the U.S. dollar has in the United States. GDP at purchaser's prices is the sum of gross value added by all resident producers in the country plus any product taxes and minus any subsidies not included in the value of the products. It is calculated without making deductions for depreciation of fabricated assets or for depletion and degradation of natural resources. Data are in constant 2017 international dollars.

### Importing Data

```{r cache = TRUE}
df_sec_ter_gdp <- WDI(indicator = c(sec = "SE.SEC.ENRR", ter = "SE.TER.ENRR", 
                                    gdppcap = "NY.GDP.PCAP.PP.KD"), extra = TRUE)
```

```{r}
write_csv(df_secgdp, "data/sec_ter_gdp.csv")
```

```{r}
df_secgdp <- read_csv("data/sec_ter_gdp.csv")
```

### Visualization by Line Graphs

```{r}
COUNTRY <- "World"
df_sec_ter_gdp |> filter(country == COUNTRY) |> drop_na(sec, ter) |>
  ggplot() + geom_line(aes(year, sec), col = "blue") + geom_line(aes(year, ter), col = "red") +
  labs(title = "School enrollment; Secondary and Tertiary", 
       subtitle = "secondary in blue and tertiary in red", y = "")
```

```{r}
INCOME <- c("Low income", "Low & middle income", "Lower middle income", "Middle income", "Upper middle income", "High income")
df_sec_ter_gdp |> filter(country %in% INCOME) |> drop_na(sec, ter) |>
  ggplot(aes(linetype = factor(country, levels = INCOME))) + geom_line(aes(year, sec), col = "blue") + geom_line(aes(year, ter), col = "red") + ylim(c(0,110)) +
  labs(title = "School enrollment; Secondary and Tertiary", 
       subtitle = "secondary in blue and tertiary in red", linetype = "Income Levels", y = "")
```

### Scatterplot for Covariation

```{r}
df_sec_ter_gdp |> filter(year == 2020) |> drop_na(sec, ter, gdppcap) |>
  ggplot() + geom_point(aes(gdppcap, sec), col = "blue") + 
  geom_point(aes(gdppcap, ter), col = "red") +
  labs(title = "School enrollment; Secondary and Tertiary vs GDP per capita", 
       subtitle = "secondary in blue and tertiary in red", y = "")
```

```{r}
df_sec_ter_gdp |> filter(year == 2020) |> drop_na(sec, ter, gdppcap) |>
  ggplot() + geom_point(aes(gdppcap, sec), col = "blue") + 
  geom_point(aes(gdppcap, ter), col = "red") + 
  scale_x_log10() +
  labs(title = "School enrollment; Secondary and Tertiary vs GDP per capita in log10 scale", 
       subtitle = "secondary in blue and tertiary in red", y = "")
```

```{r}
df_sec_ter_gdp |> filter(year == 2020) |> drop_na(sec, ter, gdppcap) |>
  ggplot() + geom_point(aes(gdppcap, sec), col = "blue") + 
  geom_point(aes(gdppcap, ter), col = "red") +
  geom_smooth(aes(gdppcap, sec), col = "blue", method = "lm", formula = 'y~x', se = FALSE) +
  geom_smooth(aes(gdppcap, ter), col = "red", method = "lm", formula = 'y~x', se = FALSE) +
  scale_x_log10() +
  labs(title = "School enrollment; Secondary and Tertiary vs GDP per capita in log10 scale", 
       subtitle = "secondary in blue and tertiary in red with regression lines", y = "")
```

```{r}
df_sec_ter_gdp |> filter(year == 2020) |> drop_na(gdppcap, sec) |>
  lm(sec~log10(gdppcap), data = _) |> summary()
```

```{r}
df_sec_ter_gdp |> filter(year == 2020) |> drop_na(gdppcap, ter) |>
  lm(ter~log10(gdppcap), data = _) |> summary()
```

```{r}
df_sec_ter_gdp |> filter(year == 2020, region != "Aggregates") |> drop_na(sec, region) |>
  ggplot(aes(sec, region, fill = region)) + geom_boxplot() + 
  labs(x = "School enrollment, secondary (% gross)", y = "") + theme(legend.position = "none")
```

```{r}
df_sec_ter_gdp |> filter(year == 2020, income !="Aggregates") |> drop_na(sec, income) |>
  ggplot(aes(sec, factor(income, levels = INCOME), fill = income)) + geom_boxplot() + 
  labs(title = "Seconary education: School enrollment by income level", x = "School enrollment, secondary (% gross)", y = "") + theme(legend.position = "none")
```

```{r}
df_sec_ter_gdp |> filter(year == 2020, region != "Aggregates") |> drop_na(ter, region) |>
  ggplot(aes(ter, region, fill = region)) + geom_boxplot() + 
  labs(x = "School enrollment, tertiary (% gross)", y = "") + theme(legend.position = "none")
```

```{r}
df_sec_ter_gdp |> filter(year == 2020, income != "Aggregates") |> drop_na(ter, income) |>
  ggplot(aes(ter, factor(income, levels = INCOME), fill = income)) + geom_boxplot() + 
  labs(title = "Tertiary education: School enrollment by income level", x = "School enrollment, tertiary (% gross)", y = "") + theme(legend.position = "none")
```

**Observations**

-   Income level has more effect on school enrollment to tertiary education

# Your Project

## Title of your project

We study .....

1.  Name of the indicator 1: Indicator Code 1

-   Description:

2.  Name of the indicator 2: Indicator Code 2

-   Description:

### Importing Data

```{=html}
<span style = "color: red;">Edit the following code chunk!</span>
```
```{r}
chosen_indicator_1 <- "SE.SEC.ENRR"
short_name_1 <- "sec"
chosen_indicator_2 <- "NY.GDP.PCAP.PP.KD"
short_name_2 <- "gdppcap"
```

```{r cache = TRUE}
df_yourdata <- WDI(indicator = c(short_name_1 = chosen_indicator_1, short_name_2 = chosen_indicator_2),
                 extra = TRUE)
```

```{r}
write_csv(df_yourdata, "data/yourdata.csv")
```

```{r}
df_yourdata <- read_csv("data/yourdata.csv")
```

### Visualization by Line Graphs

#### Name of the Indicator 1

```{=html}
<span style = "color: red;">Edit the title and the label of y-axis.</span>
```
```{r}
COUNTRY <- "World"
df_yourdata |> filter(country == COUNTRY) |> drop_na(short_name_1) |>
  ggplot(aes(year, short_name_1)) + geom_line() +
  labs(title = "",
       y = "")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit ISO2C, title, subtitle, and the label of y-axis.</span>
```
```{r}
ISO2C <- c("JP", "CN", "ID", "GB", "US", "DE", "FR")
df_yourdata |> filter(iso2c %in% ISO2C) |> drop_na(short_name_1) |>
  ggplot(aes(year, short_name_1, col = iso2c)) + geom_line() +
  labs(title = "",
       subtitle = "China, Germany, France, United Kingdom, India, Japan, United States", 
       y = "")
```

**Observations and Questions:**

-   

#### Name of the Indicator 2

```{=html}
<span style = "color: red;">Edit COUNTRY and the title.</span>
```
```{r}
COUNTRY <- "World"
df_yourdata |> filter(country == COUNTRY) |> drop_na(short_name_2) |>
  ggplot(aes(year, short_name_2)) + geom_line() +
  labs(title = "")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit ISO2C, title, subtitle, and the label of y-axis, and add caption if preferable.</span>
```
```{r}
ISO2C <- c("JP", "CN", "ID", "GB", "US", "DE", "FR")
df_yourdata |> filter(iso2c %in% ISO2C) |> drop_na(short_name_2) |>
  ggplot(aes(year, short_name_2, col = iso2c)) + geom_line() +
  labs(title = "",
       subtitle = "China, Germany, France, United Kingdom, India, Japan, United States", 
       y = "",
       caption = "")
```

**Observations and Questions:**

-   

#### Ranking of the indicator 1

```{=html}
<span style = "color: red;">Edit year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(short_name_1) |> arrange(desc(short_name_1))
```

```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(short_name_1) |> arrange(short_name_1)
```

**Observations and Questions:**

-   

#### Ranking of the Indicator 2

```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(short_name_2) |> arrange(desc(short_name_2))
```

**Observations and Questions:**

-   

```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(short_name_2) |> arrange(short_name_2)
```

**Observations and Questions:**

-   

### Histograms and Boxplots for Variation

#### Name of the Indicator 1

```{=html}
<span style = "color: red;">Edit the title and year.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(income != "Not classified") |>
  ggplot(aes(short_name_1, fill = factor(income, levels = INCOME))) + geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() +
  labs(title = "", fill = "")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title and the years.</span>
```
```{r}
df_yourdata |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(short_name_1 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_1, fill = factor(year))) + 
  geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() + facet_wrap(~year) +
  labs(title = "", fill = "")
```

**Observations and Questions:**

-   

```{r}
df_yourdata |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(short_name_1 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_1, factor(year), fill = factor(year))) + 
  geom_boxplot() + scale_x_log10() + labs(y = "") + theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title, and the year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(short_name_1 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_1, factor(income, levels = INCOME), fill = income)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "", y = "", fill = "") +
  theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title and year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(short_name_1 > 0) |> 
  ggplot(aes(short_name_1, region, fill = region)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "", y = "", fill = "") +
  theme(legend.position = "none")
```

**Observations and Questions:**

-   

#### GDP per capita

```{=html}
<span style = "color: red;">Edit the title, and year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(income != "Not classified") |>
  ggplot(aes(short_name_2, fill = factor(income, levels = INCOME))) + geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() +
  labs(title = "", fill = "")
```

```{=html}
<span style = "color: red;">Edit the title and the year if necessary.</span>
```
```{r}
df_yourdata |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(short_name_2 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_2, fill = factor(year))) + 
  geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() + facet_wrap(~year) +
  labs(title = "", fill = "") +
  theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{r}
df_yourdata |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(short_name_2 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_2, factor(year), fill = factor(year))) + 
  geom_boxplot() + scale_x_log10() + labs(y = "") + theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title, and the year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(short_name_2 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_2, factor(income, levels = INCOME), fill = income)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "", y = "", fill = "") +
  theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title and the year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(short_name_2 > 0) |> 
  ggplot(aes(short_name_2, region, fill = region)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "", y = "", fill = "") +
  theme(legend.position = "none")
```

### Scatterplot for Covariation

#### Scatterplot with a regression line

```{=html}
<span style = "color: red;">Edit the title, the labels of x- and y- axes.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> 
  drop_na(short_name_2, short_name_1) |>
  ggplot(aes(short_name_2, short_name_1)) + geom_point(aes(col = region)) +
  geom_smooth(method = "lm", formula = 'y~x', se = FALSE) +
  scale_x_log10() + scale_y_log10() +
  labs(title = "",
       x = "",
       y = "")
```

**Observations and Questions:**

-   

#### Summary of a linear model

```{=html}
<span style = "color: red;">Edit year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> drop_na(short_name_2, short_name_1) |>
  lm(log10(short_name_1)~log10(short_name_2), data = _) |> summary()
```

**Observations and Questions:**

-   
