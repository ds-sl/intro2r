---
title: "EDA using WDI"
author: "ID Last, First"
date: "`r Sys.Date()`"
output:
  html_notebook:
    number_sections: yes
    toc: yes
    toc_float: yes
---

# Exploratory Data Analysis, EDA

## About EDA

EDA is an iterative cycle that helps you understand what your data says. When you do EDA, you:

1.  Generate questions about your data

2.  Search for answers by visualising, transforming, and/or modeling your data

3.  Use what you learn to refine your questions and/or generate new questions

EDA is an important part of any data analysis. You can use EDA to make discoveries about the world; or you can use EDA to ensure the quality of your data, asking questions about whether the data meets your standards or not. (Posit Primers: [EDA](https://posit.cloud/learn/primers/3.1))

## Workflow

1.  Importing data by WDI

```         
df_dataframe_name <- WDI(indicators = c(name1 = "Indicator Code 1", 
name2 = "Indicator Code 2"), extra = TRUE)
```

Write and read:

```         
write_csv(df_dataframe_name, "data/dataframe_name.csv")
df_dataframe_name <- read_csv("data/dataframe_name.csv")
```

2.  Viewing data by

`head()`, `str()`, `summary()`, and try `df_dataframe_name`. See also Environment Tab of RStudio.

3.  Transforming data by restricting the values of a variable.

```         
df_dataframe_name |> filter(var == "value") 
df_dataframe_name |> filter(var %in% c("value_1", ... , "value_n") 
df_dataframe_name |> filter(var != "value") 
df_dataframe_name |> drop_na(var)
```

-   Creating a new variable by mutation. (A little advanced. PCAP = gdp/pop)

```         
df_dataframe_name |> mutate(var_new = var1 * var2)}
```

4.  Change orders by `arrange()`

```         
df_dataframe_name |> arrange(var)
df_dataframe_name |> arrange(desc(var))
```

5.  Visualizing using ggplot() + geom\_\*()

    What type of **variation** occurs **within** my variables?

    What type of **covariation** occurs **between** my variables?

-   line graph

```         
transformed_data |> ggplot(aes(year, name1)) + geom_line()
transformed_data |> ggplot(aes(year, name2)) + geom_line()
```

-   histogram

```         
transformed_data |> ggplot(aes(name1)) + geom_histogram()
```

-   boxplot

`categorical_var`: `factor(year)`, `income`, `region`

```         
transformed_data |> ggplot(aes(categorical_var, name1)) + geom_boxplot()
```

6.  scatterplot

```         
transformed_data |> ggplot(aes(name1, name2)) + geom_point()
transformed_data |> ggplot(aes(name1, name2)) + geom_point() + scale_x_log10()
```

-   scatterplot with a regression line

```         
transformed_data |> ggplot(aes(name1, name2)) + geom_point() +
  geom_smooth(method = "lm", se = FALSE)
transformed_data |> ggplot(aes(name1, name2)) + geom_point() + 
  geom_smooth(method = "lm", se = FALSE) + scale_x_log10()
```

7.  Do not forget to add your observations and questions.

# Example

## CO~2~ Emissions Per Capita vs GDP Per Capita

*An Example of EDA*

> **Abstract.** We study the relation between the CO~2~ emission per capita and the GDP per capita using two World Development Indicators.

### Data

1.  CO2 emissions (metric tons per capita): EN.ATM.CO2E.PC [[Link](https://data.worldbank.org/indicator/EN.ATM.CO2E.PC)]

-   Description: Carbon dioxide emissions are those stemming from the burning of fossil fuels and the manufacture of cement. They include carbon dioxide produced during consumption of solid, liquid, and gas fuels and gas flaring.

2.  GDP per capita, PPP (constant 2017 international \$): NY.GDP.PCAP.PP.KD [[Link](https://data.worldbank.org/indicator/NY.GDP.PCAP.PP.KD)]

-   Description: GDP per capita based on purchasing power parity (PPP). PPP GDP is gross domestic product converted to international dollars using purchasing power parity rates. An international dollar has the same purchasing power over GDP as the U.S. dollar has in the United States. GDP at purchaser's prices is the sum of gross value added by all resident producers in the country plus any product taxes and minus any subsidies not included in the value of the products. It is calculated without making deductions for depreciation of fabricated assets or for depletion and degradation of natural resources. Data are in constant 2017 international dollars.

### Setup

```{r}
library(tidyverse)
library(WDI)
```

*If you do not have `wdicache.rds` in your data folder, run the following two code chunks.*

```{r eval=FALSE}
wdicache <- WDIcache()
```

```{r eval=FALSE, echo=FALSE}
write_rds(wdicache, "data/wdicache.rds")
```

```{r echo=FALSE}
wdicache <- read_rds("data/wdicache.rds")
```

### Description of data

*`WDIsearch` with `short = FALSE` provides with the description of data in the last column.*

```{r}
WDIsearch(string = "EN.ATM.CO2E.PC", field = "indicator", 
          short = FALSE, cache = wdicache)
```

**Description:** Carbon dioxide emissions are those stemming from the burning of fossil fuels and the manufacture of cement. They include carbon dioxide produced during consumption of solid, liquid, and gas fuels and gas flaring.

```{r}
WDIsearch(string = "NY.GDP.PCAP.PP.KD", field = "indicator", 
          short = FALSE, cache = wdicache)
```

**Descritption:** GDP per capita based on purchasing power parity (PPP). PPP GDP is gross domestic product converted to international dollars using purchasing power parity rates. An international dollar has the same purchasing power over GDP as the U.S. dollar has in the United States. GDP at purchaser's prices is the sum of gross value added by all resident producers in the country plus any product taxes and minus any subsidies not included in the value of the products. It is calculated without making deductions for depreciation of fabricated assets or for depletion and degradation of natural resources. Data are in constant 2017 international dollars.

### Importing and saving data

*For extra information with `extra = TRUE`, we provide updated information with `cache = wdicache`.*

```{r cache = TRUE, eval = FALSE}
df_co2gdp <- WDI(indicator = c(co2pcap = "EN.ATM.CO2E.PC", 
                               gdppcap = "NY.GDP.PCAP.PP.KD"),
                 extra = TRUE, cache = wdicache)
```

```{r eval = FALSE}
write_csv(df_co2gdp, "data/co2gdp.csv")
```

```{r}
df_co2gdp <- read_csv("data/co2gdp.csv")
```

### Viewing and checking the data

*Three ways to look at the table. `df_co2gdp` , `head(df_co2gdp)` , df_co2gdp under Environment tab in the top right pane.*

```{r}
df_co2gdp
```

*If you do not add `cache = wdicache` when you download data with `extra = TRUE`, region and income of these countries would be NA as the country information attached to the package requires update using `WDIcache().`* *As for Czechia and Viet Nam, see the file [[Link](https://ds-sl.github.io/intro2r/da4r/life_expectancy.nb.html)] and its Addendum.*

```{r}
df_co2gdp |> filter(country %in% c("Czechia", "Viet Nam")) |>
  distinct(country, region, income)
```

#### Structure of data

`glimpse(df_co2gdp)` does about the same.

```{r}
str(df_co2gdp)
```

#### Select columns

```{r}
df_co2gdppcap <- df_co2gdp |> select(country, iso2c, year, co2pcap, gdppcap, region, income)
```

*Check the distinct region names under the column region or income.*

```{r}
unique(df_co2gdppcap$region)
```

*The following does the same.*

```{r}
df_co2gdppcap |> distinct(region) |> pull()
```

*Using dput() may be handy if you want to use the output.*

```{r}
unique(df_co2gdppcap$income) |> dput()
```

```{r}
INCOME <-c("Low income", "Lower middle income", "Upper middle income", 
"High income")
```

*It is possible to get the information in one code chunk.*

```{r}
df_co2gdppcap |> select(region, income) |> lapply(unique)
```

### Regions and Countries

*It is convenient to have a list at hand.*

```{r}
wdicache$country |> filter(region == "Aggregates") |> 
  distinct(country, iso2c) 
```

*Compare the following with above.*

```{r}
df_co2gdppcap |> filter(region == "Aggregates") |> 
  distinct(country, iso2c) 
```

```{r}
df_co2gdppcap |> filter(is.na(region)) |> 
  distinct(country, iso2c) 
```

### Countries

```{r}
wdicache$country |> filter(region != "Aggregates") |> 
  distinct(country, iso2c, region, income) |> arrange(country)
```

```{r}
df_co2gdppcap |> filter(region != "Aggregates") |> 
  distinct(country, iso2c, region, income) |> arrange(country)
```

Observations:

-   How can we get the difference easily?

### Number of data of each year

*Check whether you have enough data in each year.*

```{r}
df_co2gdppcap |> drop_na(co2pcap, gdppcap) |>
  ggplot(aes(year)) + geom_bar()
```

Observation:

-   The data starts in the year 1990 and ends in 2020. There are data of over 200 countries and regions.

The code above is same as the following.

```{r}
df_co2gdppcap |> drop_na(co2pcap, gdppcap) |>
  group_by(year) |> summarize(n = n()) |>
  ggplot(aes(year, n)) + geom_col()
```

### Visualization by Line Graphs

#### CO~2~ per capita

```{r}
COUNTRY <- "World"
df_co2gdppcap |> filter(country == COUNTRY) |> drop_na(co2pcap) |>
  ggplot(aes(year, co2pcap)) + geom_line() +
  labs(title = expression(paste(CO[2], " per capita of the World")),
       y = expression(paste(CO[2], " per capita in tons")))
```

Observations:

-   CO2 per capita of the World is decreasing but not much.

```{r}
ISO2C <- c("JP", "CN", "ID", "GB", "US", "DE", "FR")
df_co2gdppcap |> filter(iso2c %in% ISO2C) |> drop_na(co2pcap) |>
  ggplot(aes(year, co2pcap, col = iso2c)) + geom_line() +
  labs(title = expression(paste(CO[2], " per capita of seven conutries with large GDP")),
       subtitle = "China, Germany, France, United Kingdom, India, Japan, United States", 
       y = expression(paste(CO[2], " per capita in tons")))
```

Observations:

-   Need to study more in detail.

#### GDP per capita

```{r}
COUNTRY <- "World"
df_co2gdppcap |> filter(country == COUNTRY) |> drop_na(gdppcap) |>
  ggplot(aes(year, gdppcap)) + geom_line() +
  labs(title = "GDP per capita of the World")
```

Observations:

-   There are two drops but increasing steadily.

```{r}
ISO2C <- c("JP", "CN", "ID", "GB", "US", "DE", "FR")
df_co2gdppcap |> filter(iso2c %in% ISO2C) |> drop_na(gdppcap) |>
  ggplot(aes(year, gdppcap, col = iso2c)) + geom_line() +
  labs(title = "GDP per capita of seven countries with large GDP",
       subtitle = "China, Germany, France, United Kingdom, India, Japan, United States", 
       y = "GDP per capita PPP",
       caption = "constant 2017 international usd")
```

Observations:

-   Need to study each in detail.

#### Ranking of CO~2~ per capita

```{r}
df_co2gdppcap |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(co2pcap) |> arrange(desc(co2pcap))
```

Observations:

-   Many oil producing countries are on the top.

```{r}
df_co2gdppcap |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(co2pcap) |> arrange(co2pcap)
```

**Observations and Questions:**

-   Top 10 countries of CO~2~ emission per capita:

    -   Qtar, Bahrain, Brunei Darussalam, Kuwait, United Arab Emirates, Oman, Australia, Saudi Arabia, Canada, and United States

-   Lowest 10 countries of CO~2~ emission per capita:

    -   Congo, Dem. Rep., Somalia, Central African Republic, Burundi, Malawi, Niger, Chad, Madagascar, Rwanda, Sierra Leone

-   The top 10 is about 1000 times the bottom 10.

#### Ranking of GDP per capita

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates") |>
  drop_na(gdppcap) |> arrange(desc(gdppcap))
```

Observations:

-   Interesting. I know the ranking of GDP but not GDP per capita.

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates") |>
  drop_na(gdppcap) |> arrange(gdppcap)
```

Observations:

-   Top 10 is about 100 times the bottom 10.

### Histograms and Boxplots for Variation

#### CO~2~ per capita

*Change the bins or binwidth.*

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates") |> drop_na(co2pcap) |> 
  ggplot(aes(co2pcap)) + geom_histogram()
```

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates") |> drop_na(co2pcap) |> 
  ggplot(aes(co2pcap)) + geom_histogram(bins = 10)
```

Observations:

-   For most of the countries, the value is less than 5 tons per person per year.

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates") |> drop_na(co2pcap) |> 
  ggplot(aes(co2pcap, fill = region)) + geom_histogram(bins = 15, col = "black", linewidth = 0.2)
```

Observations:

-   Interesting but complicated.

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates") |> drop_na(co2pcap) |> 
  ggplot(aes(co2pcap, fill = factor(income, levels = INCOME))) + geom_histogram(bins = 15, col = "black", linewidth = 0.2) +
  labs(fill = "")
```

**Observations and Questions:**

-   High income countries have larger values in general.

```{r}
df_co2gdppcap |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(co2pcap) |> filter(income != "Not classified") |>
  ggplot(aes(co2pcap, fill = factor(income, levels = INCOME))) + geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() +
  labs(title = "Histogram of CO2 per capita in 2020", fill = "")
```

Observations:

-   Each of log10 scale and the raw value seems to tell different feature.

-   Need to consider NA value in income.

```{r}
df_co2gdppcap |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(co2pcap) |> filter(co2pcap > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(co2pcap, fill = factor(year))) + 
  geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() + facet_wrap(~year) +
  labs(title = "Histogram of CO2 per capita in 1990, 2000, 2010, 2020", fill = "")
```

Observations:

-   Want old data, but can see differences.

```{r}
df_co2gdppcap |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(co2pcap) |> filter(co2pcap > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(co2pcap, factor(year), fill = factor(year))) + 
  geom_boxplot() + scale_x_log10() + labs(y = "") + theme(legend.position = "none")
```

Observations:

-   Not much different but the width is decreasing.

```{r}
df_co2gdppcap |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(co2pcap) |> filter(co2pcap > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(co2pcap, factor(income, levels = INCOME), fill = income)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "CO2 per capita by income level", y = "", fill = "") +
  theme(legend.position = "none")
```

Observations:

-   The result looks natural. However, it is worth analysing outliers in detail.

```{r}
df_co2gdppcap |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(co2pcap) |> filter(co2pcap > 0) |> 
  ggplot(aes(co2pcap, region, fill = region)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "CO2 per capita by region", y = "", fill = "") +
  theme(legend.position = "none")
```

Observations:

-   Need to investigate each region closely.

#### GDP per capita

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates", !is.na(income)) |>
  drop_na(gdppcap) |> ggplot(aes(gdppcap, factor(income, levels = INCOME), fill = income)) + geom_boxplot() + scale_x_log10() + theme(legend.position = "none") + labs(y = "")
```

Observations:

-   There are overlaps. Need to study how the income level is determined by World Bank.

    -   How does the World Bank classify countries? [[Link](https://datahelpdesk.worldbank.org/knowledgebase/articles/378834-how-does-the-world-bank-classify-countries)]

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates", !is.na(region)) |>
  drop_na(gdppcap) |>
  ggplot(aes(gdppcap, fill = region)) + geom_histogram(bins = 15, col = "black", linewidth = 0.2) + 
  labs(fill = "")
```

Observations:

-   Interesting but complicated.

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  filter(region != "Aggregates", !is.na(region)) |>
  drop_na(gdppcap) |>
  ggplot(aes(gdppcap, fill = region)) + geom_histogram(bins = 15, col = "black", linewidth = 0.2) + scale_x_log10() +
  labs(fill = "")
```

Observations:

-   Two scales give different information and impression.

```{r}
df_co2gdppcap |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(gdppcap) |> filter(income != "Not classified") |>
  ggplot(aes(gdppcap, fill = factor(income, levels = INCOME))) + geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() +
  labs(title = "Histogram of GDP per capita in 2020", fill = "")
```

Observations:

-   Need to study overlaps.

```{r}
df_co2gdppcap |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(gdppcap) |> filter(gdppcap > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(gdppcap, fill = factor(year))) + 
  geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() + facet_wrap(~year) +
  labs(title = "Histogram of GDP per capita in 1990, 2000, 2010, 2020", fill = "") +
  theme(legend.position = "none")
```

Observations:

-   Cannot see a big difference.

```{r}
df_co2gdppcap |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(gdppcap) |> filter(gdppcap > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(gdppcap, factor(year), fill = factor(year))) + 
  geom_boxplot() + scale_x_log10() + labs(y = "") + theme(legend.position = "none")
```

Observations:

-   Not much can be seen.

```{r}
df_co2gdppcap |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(gdppcap) |> filter(gdppcap > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(gdppcap, factor(income, levels = INCOME), fill = income)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "GDP per capita by income level", y = "", fill = "") +
  theme(legend.position = "none")
```

Observations:

-   Can see a trend.

```{r}
df_co2gdppcap |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(gdppcap) |> filter(gdppcap > 0) |> 
  ggplot(aes(gdppcap, region, fill = region)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "GDP per capita by region", y = "", fill = "") +
  theme(legend.position = "none")
```

Observations:

-   What is the best way to look at regional differences?

### Scatterplot for Covariation

#### Scatterplot with a regression line

```{r}
df_co2gdppcap |> filter(year == 2020) |> 
  drop_na(gdppcap, co2pcap) |>
  ggplot(aes(gdppcap, co2pcap)) + geom_point(aes(col = region)) +
  geom_smooth(method = "lm", formula = 'y~x', se = FALSE) +
  scale_x_log10() + scale_y_log10() +
  labs(title = "GDP per capita vs CO2 per capita",
       x = "GDP per capita",
       y = expression(paste(CO[2], " per capita in tons")))
```

Observations:

-   GDP per capita in log10 scale and Co2 per capita relates positively and the regression line looks well-fit.

#### Summary of a linear model

*You will learn how to interprete the values below later in this course.*

```{r}
df_co2gdppcap |> filter(year == 2020) |> drop_na(gdppcap, co2pcap) |>
  lm(log10(co2pcap)~log10(gdppcap), data = _) |> summary()
```

Observations:

-   In log10 scale, the regression line fits well with slope 1.1.

-   Multiple R-square is 0.84 and the linear regression explains good part of the relation of these data.

# Your Project

## Title of your project

We study .....

1.  Name of the indicator 1: Indicator Code 1

-   Description:

2.  Name of the indicator 2: Indicator Code 2

-   Description:

### Set up

```{r}
library(tidyverse)
library(WDI)
```

*Create data folder if you do not have it under Files.*

```{r eval=FALSE}
dir.create("data")
```

*If you do not have `wdicache.rds` in your data folder, run the following two code chunks.*

```{r eval=FALSE}
wdicache <- WDIcache()
```

```{r eval=FALSE, echo=FALSE}
write_rds(wdicache, "data/wdicache.rds")
```

```{r echo=FALSE}
wdicache <- read_rds("data/wdicache.rds")
```

### Importing Data

```{=html}
<span style = "color: red;">Edit the following code chunk!</span>
```
```{r}
chosen_indicator_1 <- "SE.SEC.ENRR" #example
short_name_1 <- "sec"
chosen_indicator_2 <- "NY.GDP.PCAP.PP.KD" #example
short_name_2 <- "gdppcap"
```

```{r cache = TRUE}
df_yourdata <- WDI(indicator = c(short_name_1 = chosen_indicator_1,
                                 short_name_2 = chosen_indicator_2),
                 extra = TRUE, cache = wdicache)
```

```{r}
write_csv(df_yourdata, "data/yourdata.csv")
```

```{r}
df_yourdata <- read_csv("data/yourdata.csv")
```

### Visualization by Line Graphs

#### Name of the Indicator 1

```{=html}
<span style = "color: red;">Edit the title and the label of y-axis.</span>
```
```{r}
COUNTRY <- "World"
df_yourdata |> filter(country == COUNTRY) |> drop_na(short_name_1) |>
  ggplot(aes(year, short_name_1)) + geom_line() +
  labs(title = "",
       y = "")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit ISO2C, title, subtitle, and the label of y-axis.</span>
```
```{r}
ISO2C <- c("JP", "CN", "ID", "GB", "US", "DE", "FR")
df_yourdata |> filter(iso2c %in% ISO2C) |> drop_na(short_name_1) |>
  ggplot(aes(year, short_name_1, col = iso2c)) + geom_line() +
  labs(title = "",
       subtitle = "China, Germany, France, United Kingdom, India, Japan, United States", 
       y = "")
```

**Observations and Questions:**

-   

#### Name of the Indicator 2

```{=html}
<span style = "color: red;">Edit COUNTRY and the title.</span>
```
```{r}
COUNTRY <- "World"
df_yourdata |> filter(country == COUNTRY) |> drop_na(short_name_2) |>
  ggplot(aes(year, short_name_2)) + geom_line() +
  labs(title = "")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit ISO2C, title, subtitle, and the label of y-axis, and add caption if preferable.</span>
```
```{r}
ISO2C <- c("JP", "CN", "ID", "GB", "US", "DE", "FR")
df_yourdata |> filter(iso2c %in% ISO2C) |> drop_na(short_name_2) |>
  ggplot(aes(year, short_name_2, col = iso2c)) + geom_line() +
  labs(title = "",
       subtitle = "China, Germany, France, United Kingdom, India, Japan, United States", 
       y = "",
       caption = "")
```

**Observations and Questions:**

-   

#### Ranking of the indicator 1

```{=html}
<span style = "color: red;">Edit year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(short_name_1) |> arrange(desc(short_name_1))
```

```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(short_name_1) |> arrange(short_name_1)
```

**Observations and Questions:**

-   

#### Ranking of the Indicator 2

```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(short_name_2) |> arrange(desc(short_name_2))
```

**Observations and Questions:**

-   

```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |>
  drop_na(short_name_2) |> arrange(short_name_2)
```

**Observations and Questions:**

-   

### Histograms and Boxplots for Variation

#### Name of the Indicator 1

```{=html}
<span style = "color: red;">Edit the title and year.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(income != "Not classified") |>
  ggplot(aes(short_name_1, fill = factor(income, levels = INCOME))) + geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() +
  labs(title = "", fill = "")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title and the years.</span>
```
```{r}
df_yourdata |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(short_name_1 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_1, fill = factor(year))) + 
  geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() + facet_wrap(~year) +
  labs(title = "", fill = "")
```

**Observations and Questions:**

-   

```{r}
df_yourdata |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(short_name_1 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_1, factor(year), fill = factor(year))) + 
  geom_boxplot() + scale_x_log10() + labs(y = "") + theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title, and the year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(short_name_1 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_1, factor(income, levels = INCOME), fill = income)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "", y = "", fill = "") +
  theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title and year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_1) |> filter(short_name_1 > 0) |> 
  ggplot(aes(short_name_1, region, fill = region)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "", y = "", fill = "") +
  theme(legend.position = "none")
```

**Observations and Questions:**

-   

#### GDP per capita

```{=html}
<span style = "color: red;">Edit the title, and year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(income != "Not classified") |>
  ggplot(aes(short_name_2, fill = factor(income, levels = INCOME))) + geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() +
  labs(title = "", fill = "")
```

```{=html}
<span style = "color: red;">Edit the title and the year if necessary.</span>
```
```{r}
df_yourdata |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(short_name_2 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_2, fill = factor(year))) + 
  geom_histogram(bins = 15, col = "black", linewidth = 0.1) + 
  scale_x_log10() + facet_wrap(~year) +
  labs(title = "", fill = "") +
  theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{r}
df_yourdata |> filter(year %in% c(1990, 2000, 2010, 2020)) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(short_name_2 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_2, factor(year), fill = factor(year))) + 
  geom_boxplot() + scale_x_log10() + labs(y = "") + theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title, and the year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(short_name_2 > 0) |> filter(income != "Not classified") |> 
  ggplot(aes(short_name_2, factor(income, levels = INCOME), fill = income)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "", y = "", fill = "") +
  theme(legend.position = "none")
```

**Observations and Questions:**

-   

```{=html}
<span style = "color: red;">Edit the title and the year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> filter(region != "Aggregates") |> 
  drop_na(short_name_2) |> filter(short_name_2 > 0) |> 
  ggplot(aes(short_name_2, region, fill = region)) + 
  geom_boxplot() + scale_x_log10() + 
  labs(title = "", y = "", fill = "") +
  theme(legend.position = "none")
```

### Scatterplot for Covariation

#### Scatterplot with a regression line

```{=html}
<span style = "color: red;">Edit the title, the labels of x- and y- axes.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> 
  drop_na(short_name_2, short_name_1) |>
  ggplot(aes(short_name_2, short_name_1)) + geom_point(aes(col = region)) +
  geom_smooth(method = "lm", formula = 'y~x', se = FALSE) +
  scale_x_log10() + scale_y_log10() +
  labs(title = "",
       x = "",
       y = "")
```

**Observations and Questions:**

-   

#### Summary of a linear model

```{=html}
<span style = "color: red;">Edit year if necessary.</span>
```
```{r}
df_yourdata |> filter(year == 2020) |> drop_na(short_name_2, short_name_1) |>
  lm(log10(short_name_1)~log10(short_name_2), data = _) |> summary()
```

**Observations and Questions:**

-   
