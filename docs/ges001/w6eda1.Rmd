---
title: "第6週 探索的データ分析 - EDA, Part II"
author: "ID, Last, First"
date: "2024年1月30日"
output:
  html_notebook: default
---

## 演習

以下の指標の中から、二つを選択して、データの概要（description）を記録し、データを WDI で取得し、以下の分析をする。

1.  各年毎のデータの数の棒グラフ
2.  国または地域を選択
3.  それぞれの経年変化を表す折れ線グラフ
    a.  日本
    b.  選択した国または地域
4.  二つのデータの散布図-必要に応じて log10 スケールを用いる
    a.  すべての値の散布図
    b.  NA ではない値の散布図、近似（回帰）直線を表示
    c.  地域を除き国のみの散布図、近似（回帰）直線を表示
    d.  最近の年を選択し、地域を除き国のもの散布図、近似（回帰）直線を表示

それぞれについて考察（気づいたこと、疑問など）を記す

<!-- **2023.2.3.23:59** までに Moodle の演習の課題ボックスに提出したものについては、なるべく、早く見て、フィードバックを書きます。それ以降に提出されたものも見ますが、フィードバックは遅くなると思ってください。 -->



### データ情報

-   CO2 emissions (metric tons per capita) ：EN.ATM.CO2E.PC [[Link](https://data.worldbank.org/indicator/EN.ATM.CO2E.PC)] (co2pcap)

-   Forest area (% of land area)：AG.LND.FRST.ZS [[Link](https://data.worldbank.org/indicator/AG.LND.FRST.ZS)] (forest)

-   Renewable electricity output (% of total electricity output)：EG.ELC.RNEW.ZS [[Link](https://data.worldbank.org/indicator/EG.ELC.RNEW.ZS)] (renewable)

-   Electricity production from oil, gas and coal sources (% of total)：EG.ELC.FOSL.ZS [[Link](https://data.worldbank.org/indicator/EG.ELC.FOSL.ZS)] (fossil)

-   Electricity production from nuclear sources (% of total)：EG.ELC.NUCL.ZS [[Link](https://data.worldbank.org/indicator/EG.ELC.NUCL.ZS)] (nuclear)


# タイトル

## データ

### データ情報

-   データ１：名前、コード、変数名、リンク

-   概要：

-   データ２：名前、コード、変数名、リンク

-   概要：



### データの取得

#### 準備

```{r}
library(tidyverse)
library(WDI)
```

データのダウンロードと保存：コードと変数名を指定。

_データの名前は、変えたほうがよいので、例でも、df_w6eda_2 や、df_w6_2 に変えてあります。自分で決めたものを使うと、より練習になります。_

```
df_w6eda_2 <- WDI(indicator = c(co2pcap = "EN.ATM.CO2E.PC",
                              forest = "AG.LND.FRST.ZS"),
                extra = TRUE)
```

```{r eval = FALSE}


```

*２回目からは、data から読み込めるようにしておく ファイル (Rmd) の保存場所に data フォルダがあることを確認*

```
write_csv(df_w6eda_2, "data/w6eda_1.csv")
```

```{r eval = FALSE}

```

```
df_w6eda_2 <- read_csv("data/w6eda_2.csv")
```

```{r}

```

### データの確認

```
df_w6eda_2
```

```{r}

```

```
str(df_w6eda_2)
```

```{r}

```

#### 変数の選択（selecting）

```
df_w6_2 <- df_w6eda_2 |> 
  select(country, iso2c, year, co2pcap, forest, region, income)
df_w6_2
```

```{r}


```

### 各年毎のデータの数の棒グラフ

```
df_w6eda_2 |> drop_na(co2pcap, forest) |>
  ggplot(aes(year)) + geom_bar()
```

```{r}


```


### 国と地域

country には、国と地域両方が入っています。地域の iso2c は以下のものです。

```{r}
REGION <- c("1A", "1W", "4E", "6F", "6N", "6X", "7E", "8S", "A4", "A5", 
"A9", "B1", "B2", "B3", "B4", "B6", "B7", "B8", "C4", "C5", "C6", 
"C7", "C8", "C9", "D2", "D3", "D4", "D5", "D6", "D7", "EU", "F1", 
"F6", "M1", "M2", "N6", "OE", "R6", "S1", "S2", "S3", "S4", "T2", 
"T3", "T4", "T5", "T6", "T7", "V1", "V2", "V3", "V4", "XC", "XD", 
"XE", "XF", "XG", "XH", "XI", "XJ", "XL", "XM", "XN", "XO", "XP", 
"XQ", "XT", "XU", "XY", "Z4", "Z7", "ZB", "ZF", "ZG", "ZH", "ZI", 
"ZJ", "ZQ", "ZT")
```



#### 地域のリストを表示

```
df_w6eda_2 |> filter(iso2c %in% REGION) |> distinct(country, iso2c)
```

```{r}

```

#### 国名とその地域・所得レベルを表示

```
df_w6eda_2 |> filter(!(iso2c %in% REGION)) |> distinct(country, iso2c, region, income)
```

```{r}

```

### 分析する国のリスト

```
BRICS <- c("Brazil", "Russian Federation", "India", "China", "South Africa")
```

```{r}

```

### 経年変化

### a. 日本

```
df_w6_2 |> drop_na(co2pcap) |> filter(country == "Japan") |>
  ggplot(aes(year, co2pcap)) + geom_line() + 
  labs(title = "日本の一人当たりの二酸化炭素排出量")
```

```{r}


```

**気づいたこと・疑問**

```
df_w6_2 |> drop_na(forest) |> filter(country == "Japan") |>
  ggplot(aes(year, forest)) + geom_line() + 
  labs(title = "日本の森林面積（％）")
```

```{r}


```

**気づいたこと・疑問**

### b. 選択した国・地域

```
df_w6_2 |> drop_na(co2pcap) |> filter(country %in% BRICS) |>
  ggplot(aes(year, co2pcap, col = country)) + geom_line() + 
  labs(title = "BRICS の一人当たりの二酸化炭素排出量")
```

```{r}


```

**気づいたこと・疑問**

```
df_w6_2 |> drop_na(forest) |> filter(country %in% BRICS) |>
  ggplot(aes(year, forest, col = country)) + geom_line() + 
  labs(title = "BRICSの森林面積（％）")
```

```{r}


```

**気づいたこと・疑問**

### 二つのデータの散布図

必要に応じて log10 スケール

#### a. すべての値の散布図

```
df_w6_2 |> ggplot(aes(forest, co2pcap, col = region)) + geom_point()
```

```{r}

```

#### b. NA ではない値の散布図、近似（回帰）直線を表示

```
df_w6_2 |> drop_na(co2pcap, forest) |> 
  ggplot(aes(forest, co2pcap)) + geom_point(aes(col = region)) +
  geom_smooth(formula = 'y~x', method = "lm", se = FALSE)
```

```{r}


```

#### c. 地域を除き国のみの散布図、近似（回帰）直線を表示

```
df_w6_2 |> filter(!(iso2c %in% REGION)) |> drop_na(co2pcap, forest) |> 
  ggplot(aes(forest, co2pcap)) + geom_point(aes(col = region)) +
  geom_smooth(formula = 'y~x', method = "lm", se = FALSE)
```

```{r}


```

#### d. 最近の年を選択し、地域を除き国のもの散布図、近似（回帰）直線を表示

```
df_w6_2 |> filter(!(iso2c %in% REGION)) |> filter(year == 2020) |> drop_na(co2pcap, forest) |> 
  ggplot(aes(forest, co2pcap)) + geom_point(aes(col = region)) +
  geom_smooth(formula = 'y~x', method = "lm", se = FALSE)
```

```{r}


```

**気づいたこと・疑問**



```
df_w6_2 |> filter(!(iso2c %in% REGION)) |> filter(year == 2020) |> drop_na(co2pcap, forest) |> 
  select(co2pcap, forest) |> cor() 
```


```{r}


```

**気づいたこと・疑問**
