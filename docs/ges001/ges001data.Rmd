---
title: "GES 001 経済と経済学"
author: "H. Suzuki"
date: "`r Sys.Date()`"
output:
  html_notebook: default
---

## **このコースで使用するデータのリスト**

### 第1週

-   PositCloud: <https://posit.cloud/>

-   PositCloud 共有リンク：<https://posit.cloud/content/5539763>

-   極度に貧しい！？ [[RNotebook](https://ds-sl.github.io/intro2r/ges001/poverty.nb.html)]

### 第2週

12/19(TU)　Rでデータサイエンス2：人口の少子高齢化　 [[スライド](https://ds-sl.github.io/intro2r/ges001/ges00101.html)]・[[RNotebook](https://ds-sl.github.io/intro2r/ges001/ges00101.nb.html)]・[[ビデオ](https://youtu.be/AFNVhNdWZ_Y)]

-   **人口動態 [[R Notebook](https://ds-sl.github.io/intro2r/ges001/demography.nb.html)**]

#### 世界開発指標（World Development Indicators）[[Link](https://datatopics.worldbank.org/world-development-indicators/)]

-   コース全体で、世界開発指標を利用します。授業で利用する指標は、海蔵寺先生に選択していただいたものですが、リンク先の Data Themes などから、データを探すことができます。データ名だけでなく、下でも示しているように、データ ID（データコードとも呼ばれる）や、リンクを控えておくと、あとから、データ概要などを探す時にも役に立ちます。概要は、Details に書かれています。

-   他に `WDIsearch()` という、WDI パッケージの関数を利用することも可能です。このファイルの一番下を参照してください。

**People- Population dynamics**

-   総人口　Population, total：SP.POP.TOTL [[Link](https://data.worldbank.org/indicator/SP.POP.TOTL)]

-   出生率（千人）Birth rate, crude (per 1,000 people)：SP.DYN.CBRT.IN [[Link](https://data.worldbank.org/indicator/SP.DYN.CBRT.IN)]

-   死亡率（千人）Death rate, crude (per 1,000 people)：SP.DYN.CDRT.IN [[Link](https://data.worldbank.org/indicator/SP.DYN.CDRT.IN)]

-   若年労働依存率　Age dependency ratio, young (% of working-age population)：SP.POP.DPND.YG [[Link](https://data.worldbank.org/indicator/SP.POP.DPND.YG)]

-   高齢者労働依存率　Age dependency ratio, old (% of working-age population)：SP.POP.DPND.OL [[Link](https://data.worldbank.org/indicator/SP.POP.DPND.OL)]

### 第3週

01/09(TU)　Rでデータサイエンス3：GNI係数と所得分布　 [[スライド](https://ds-sl.github.io/intro2r/ges001/ges00102.html)]・[[R Notebook](https://ds-sl.github.io/intro2r/ges001/ges00102.nb.html)]・[[ビデオ](https://youtu.be/RwD-SJlSHkQ)]

-   ジニって何！？（what_is_gini.Rmd） [[R Notebook](https://ds-sl.github.io/intro2r/ges001/what_is_gini.nb.html)], [[Rmd](https://github.com/ds-sl/intro2r/blob/main/docs/ges001/what_is_gini.Rmd)]

-   ジニ指数と所得分布（gini.Rmd） [[R Notebook](https://ds-sl.github.io/intro2r/ges001/gini.nb.html)], [[Rmd](https://github.com/ds-sl/intro2r/blob/main/docs/ges001/gini.Rmd)]

    -   参考1/参考2付（gini_long.Rmd） [[R Notebook](https://ds-sl.github.io/intro2r/ges001/gini_long.nb.html)]

**Poverty and Inequality―Distribution of income or consumption**

-   GINI 指数 (世界銀行推計)：SI.POV.GINI [[Link](https://data.worldbank.org/indicator/SI.POV.GINI)]

-   下位 10% が占める所得シェア：SI.DST.FRST.10 [[Link](https://databank.worldbank.org/metadataglossary/world-development-indicators/series/SI.DST.FRST.10)]

-   下位 20% が占める所得シェア：SI.DST.FRST.20 [[Link](https://databank.worldbank.org/metadataglossary/world-development-indicators/series/SI.DST.FRST.20)]

-   2番目の 20% が占める収入シェア：SI.DST.02ND.20 [[Link](https://databank.worldbank.org/metadataglossary/world-development-indicators/series/SI.DST.02ND.20)]

-   3番目の 20% が占める収入シェア ：SI.DST.03RD.20 [[Link](https://data.worldbank.org/indicator/SI.DST.03RD.20)]

-   4番目の 20% が占める収入シェア：SI.DST.04TH.20 [[Link](https://databank.worldbank.org/metadataglossary/world-development-indicators/series/SI.DST.04TH.20)]

-   上位 20% が占める収入シェア：SI.DST.05TH.20 [[Link](https://data.worldbank.org/indicator/SI.DST.05TH.20)]

-   上位 10% が占める収入シェア：SI.DST.10TH.10 [[Link](https://data.worldbank.org/indicator/SI.DST.10TH.10)]

### 第4週

01/16(TU)　Rでデータサイエンス4:貧困 [[スライド](https://ds-sl.github.io/intro2r/ges001/ges00110.html)]・[[R Notebook](https://ds-sl.github.io/intro2r/ges001/ges00110.nb.html)]・[[ビデオ](https://youtu.be/RwD-SJlSHkQ)]

-   貧困率 - Poverty Rate [[R Notebook](https://ds-sl.github.io/intro2r/ges001/poverty_rate.nb.html)]

**Poverty rates at national poverty lines**

-   国ごとの貧困率：Poverty headcount ratio at national poverty lines (% of population)：SI.POV.NAHC [[Link](https://data.worldbank.org/indicator/SI.POV.NAHC)]

**Poverty and Inequality―Poverty rates at international poverty lines**

-   １日2.15ドル以下の人口：Poverty headcount ratio at \$2.15 a day (2017 PPP) (% of population)：SI.POV.DDAY [[Link](https://data.worldbank.org/indicator/SI.POV.DDAY)]

-   １日3.65ドル以下の人口：Poverty headcount ratio at \$3.65 a day (2017 PPP) (% of population)：SI.POV.LMIC [[Link](https://data.worldbank.org/indicator/SI.POV.LMIC)]

-   １日6.85ドル以下の人口：Poverty headcount ratio at \$6.85 a day (2017 PPP) (% of population)：SI.POV.UMIC [[Link](https://data.worldbank.org/indicator/SI.POV.UMIC)]

### 第5週

01/23(TU)　Rでデータサイエンス5　 [[スライド](https://ds-sl.github.io/intro2r/ges001/ges00111.html)]・[[R Notebook](https://ds-sl.github.io/intro2r/ges001/ges00111.nb.html)]・[[ビデオ](https://youtu.be/WHIz4Vec4ek)]

-   男女別失業率 [[R Notebook](https://ds-sl.github.io/intro2r/ges001/unemployment.nb.html)]

-   練習と一つ目の課題（w5eda.Rmd） [[R Notebook](https://ds-sl.github.io/intro2r/ges001/w5eda.nb.html)], [[Rmd](https://github.com/ds-sl/intro2r/blob/main/docs/ges001/w5eda.Rmd)]

-   二つ目以降の課題：w5eda1.Rmd [[R Notebook](https://ds-sl.github.io/intro2r/ges001/w5eda1.nb.html)], [[Rmd](https://github.com/ds-sl/intro2r/blob/main/docs/ges001/w5eda1.Rmd)]

-   解答例：w5eda0.Rmd [[R Notebook](https://ds-sl.github.io/intro2r/ges001/w5eda0.nb.html)], [[Rmd](https://github.com/ds-sl/intro2r/blob/main/docs/ges001/w5eda0.Rmd)]

**People-Education**

-   教育に関する政府支出の対GDP比率：Government expenditure on education, total (% of GDP)：SE.XPD.TOTL.GD.ZS [[Link](https://data.worldbank.org/indicator/SE.XPD.TOTL.GD.ZS)]

-   初等学校就学率：School enrollment, primary (% gross)：SE.PRM.ENRR [[Link](https://data.worldbank.org/indicator/SE.PRM.ENRR)]

-   中等学校就学率：School enrollment, secondary (% gross)：SE.SEC.ENRR [[Link](https://data.worldbank.org/indicator/SE.SEC.ENRR)]

-   中等学校後の就学率：School enrollment, tertiary (% gross)：SE.TER.ENRR [[Link](https://data.worldbank.org/indicator/SE.TER.ENRR)]

**Health**

-   千人中の五歳未満死亡率：Mortality rate, under-5 (per 1,000 live births)：SH.DYN.MORT [[Link](https://databank.worldbank.org/metadataglossary/world-development-indicators/series/SH.DYN.MORT)]

-   HIVの感染率：Incidence of HIV (% of uninfected population ages 15-49)：SH.HIV.INCD.ZS [[Link](https://data.worldbank.org/indicator/SH.HIV.INCD.ZS?locations=SZ)]

**Gender**

-   初等中等学校就学率におけるGPI：School enrollment, primary and secondary (gross), gender parity index (GPI)：SE.ENR.PRSC.FM.ZS [[Link](https://data.worldbank.org/indicator/SE.ENR.PRSC.FM.ZS)]

-   就労率のGPI：Ratio of female to male labor force participation rate (%) (modeled ILO estimate)：SL.TLF.CACT.FM.ZS [[Link](https://data.worldbank.org/indicator/SL.TLF.CACT.FM.ZS)]

**Labor**

-   女性の失業率：Unemployment, female (% of female labor force) (modeled ILO estimate)：SL.UEM.TOTL.FE.ZS [[Link](https://data.worldbank.org/indicator/SL.UEM.TOTL.FE.ZS)]

-   男性の失業率：Unemployment, male (% of male labor force) (modeled ILO estimate)：SL.UEM.TOTL.MA.ZS [[Link](https://data.worldbank.org/indicator/SL.UEM.TOTL.MA.ZS)]

**Global Link - Aid dependency**

-   政府開発援助受給額：Net official development assistance and official aid received (current US\$) DT.ODA.ALLD.CD [[Link](https://data.worldbank.org/indicator/DT.ODA.ALLD.CD)]

### 第6週

01/30(TU)　Rでデータサイエンス6：気候変動　 [[スライド](https://ds-sl.github.io/intro2r/ges001/ges00112.html)]・[[R Notebook](https://ds-sl.github.io/intro2r/ges001/ges00112.nb.html)]・[[ビデオ](https://youtu.be/Zj_gK6XYaHs)]

-   環境について [[R Notebook](https://ds-sl.github.io/intro2r/ges001/w6eda0.nb.html)]

**Environment-Climate**　

-   一人当たりの二酸化炭素排出率：CO2 emissions (metric tons per capita) ：EN.ATM.CO2E.PC [[Link](https://data.worldbank.org/indicator/EN.ATM.CO2E.PC)]

-   森林の面積率：Forest area (% of land area)：AG.LND.FRST.ZS [[Link](https://data.worldbank.org/indicator/AG.LND.FRST.ZS)]

-   再生可能エネルギーによる発電割合：Renewable electricity output (% of total electricity output)：EG.ELC.RNEW.ZS [[Link](https://data.worldbank.org/indicator/EG.ELC.RNEW.ZS)]

-   化石燃料による発電割合：Electricity production from oil, gas and coal sources (% of total)：EG.ELC.FOSL.ZS [[Link](https://data.worldbank.org/indicator/EG.ELC.FOSL.ZS)]

-   原子力による発電割合：Electricity production from nuclear sources (% of total)：EG.ELC.NUCL.ZS [[Link](https://data.worldbank.org/indicator/EG.ELC.NUCL.ZS)]

### 第7週

02/06 (TU)　Rでデータサイエンス7：都市部と農村部の生活状況の格差　 [[スライド](https://ds-sl.github.io/intro2r/ges001/ges00120.html)]・[[R Notebook](https://ds-sl.github.io/intro2r/ges001/ges00120.nb.html)]・[ビデオ]

**Urban and rural development**

-   都市での電気受給率：Access to electricity, urban (% of urban population)：EG.ELC.ACCS.UR.ZS [[Link](https://data.worldbank.org/indicator/EG.ELC.ACCS.UR.ZS)]

-   都市以外での電気受給率：Access to electricity, rural (% of rural population)：EG.ELC.ACCS.RU.ZS [[Link](https://data.worldbank.org/indicator/EG.ELC.ACCS.RU.ZS)]

-   都市での飲料水受給率：People using at least basic drinking water services, urban (% of urban population)：SH.H2O.BASW.UR.ZS [[Link](https://data.worldbank.org/indicator/SH.H2O.BASW.ZS)]

-   都市以外での飲料水受給率：People using at least basic drinking water services, rural (% of rural population)：SH.H2O.BASW.RU.ZS [[Link](https://data.worldbank.org/indicator/SH.H2O.BASW.RU.ZS)]

-   都市での基本的衛生サービス受給率：People using at least basic sanitation services, urban (% of urban population)：SH.STA.BASS.UR.ZS [[Link](https://data.worldbank.org/indicator/SH.STA.BASS.UR.ZS)]

-   都市以外での基本的衛生サービス受給率：People using at least basic sanitation services, rural (% of rural population)：SH.STA.BASS.RU.ZS [[Link](https://data.worldbank.org/indicator/SH.STA.BASS.RU.ZS)]

### 第8週

02/13(TU)　Rでデータサイエンス8：難民、軍事支出　 [[スライド](https://ds-sl.github.io/intro2r/ges001/ges00121.html)]・[[R Notebook](https://ds-sl.github.io/intro2r/ges001/ges00121.nb.html)]・[[ビデオ](https://youtu.be/mq2Y83CGI4Q)]

-   難民の出身国と受け入れ国 [[R Notebook](https://ds-sl.github.io/intro2r/ges001/peace0.nb.html)]

**Global Link-Refugees**

-   難民受け入れ国：Refugee population by country or territory of asylum：SM.POP.REFG [[Link](https://data.worldbank.org/indicator/SM.POP.REFG)]

-   難民の出身国：Refugee population by country or territory of origin：SM.POP.REFG.OR [[Link](https://data.worldbank.org/indicator/SM.POP.REFG.OR)]

-   政府開発援助受け入れ（国民総生産に対する率）：Net ODA received (% of GNI)：DT.ODA.ODAT.GN.ZS [[Link](https://data.worldbank.org/indicator/DT.ODA.ODAT.GN.ZS)]

-   政府開発援助額（USD）：Net official development assistance and official aid received (current US\$)：DT.ODA.ALLD.CD [[Link](https://data.worldbank.org/indicator/DT.ODA.ALLD.CD)]

-   政府開発援助（政府の支出額に対する率）：Net ODA received (% of central government expense)：DT.ODA.ODAT.XP.ZS [[Link](https://data.worldbank.org/indicator/DT.ODA.ODAT.XP.ZS)]

-   軍事費（USD）：Military expenditure (current USD)：MS.MIL.XPND.CD [[Link](https://data.worldbank.org/indicator/MS.MIL.XPND.CD)]

-   軍事費（政府の総支出額に対する率）：Military expenditure (% of general government expenditure)：MS.MIL.XPND.ZS [[Link](https://data.worldbank.org/indicator/MS.MIL.XPND.ZS)]

-   武器輸入値：Arms imports (SIPRI trend indicator values)：MS.MIL.MPRT.KD [[Link](https://databank.worldbank.org/metadataglossary/world-development-indicators/series/MS.MIL.MPRT.KD)]

-   武器輸出値：Arms exports (SIPRI trend indicator values)：MS.MIL.XPRT.KD [[Link](https://databank.worldbank.org/metadataglossary/world-development-indicators/series/MS.MIL.XPRT.KD)]

### 第9週

02/20(TU)　Rでデータサイエンス9：まとめと演習　[[スライド](https://ds-sl.github.io/intro2r/ges001/ges00122.html)]・[[R Notebook](https://ds-sl.github.io/intro2r/ges001/ges00122.nb.html)]・[[ビデオ](https://youtu.be/ddRCdN6tVjw)]

### 第10週

02/27(TU)　まとめ

## WDI パッケージでデータを探す方法

```{r}
library(tidyverse)
library(WDI)
```

WDI パッケージには、WDIsearch() という、データを探す機能も付属しています。また、WDIcache() で、メタデータ（データのデータ、データ情報）の最新情報を入手しておくと、検索も素早く行うことができます。

詳細は、Help の検索窓に、WDIsearch と入れて、調べてください。みんなの[データサイエンスの当該箇所](<https://icu-hsuzuki.github.io/ds4aj/worldbank.html#worldbank>)にも書かれています。

### 簡単な検索

WDIsearch("検索語") とすると、検索語が、指標名（name）に現れる指標を検索してくれます。次の例では、313 の指標を返しています。

```{r}
WDIsearch("poverty")
```

とすると 71 に減りました。

```{r}
WDIsearch("poverty line")
```

### 概要を入手

short = FALSE を加えると、概要（description）も得られます。

```{r}
WDIsearch("refugee", short = FALSE)
```

### 指標（ID）から検索

指標がわかっていて、その詳細情報（名前や概要）が必要な時は、次のようにします。

```{r}
WDIsearch("SM.POP.REFG.OR", field = "indicator", short = FALSE)
```

### 他の検索

実は、WDIsearch("refugee") や、WDIsearch("refugee", short = FALSE) では、初期値として、field = "name" として入っているので、書かなくて良いのでした。"indicator" を "description", "sourceDatabase", "sourceOrganization" に変更すると、そこに含まれる情報を入手できます。

```{r}
WDIsearch("UNICEF", field = "sourceOrganization")
```

### 高度な検索

`WDIcache()` で最新情報にアップデートしておくと、いろいろと便利です。

```{r include = FALSE}
wdicache <- read_rds("data/wdicache.rds")
```


```{r eval = FALSE}
wdicache <- WDIcache()
```

下の結果から、series と country の二つのデータ（data.frame）からなっていることがわかります。series には、すべての指標（WDI）情報、country には、すべての国の情報が含まれています。

```{r}
wdicache |> str(max.level = 1)
```

```{r}
wdicache$series
```

```{r}
wdicache$country
```

ですから、あとは、indicator を探すときは、wdicache$series を使って、filter などでとれば良いことになります。一応、列を確認しておきます。

```{r}
wdicache$series |> str()
```

filter は一般的には、一致したものしか、探せませんが、grepl を使うことで、検索語を含むものを探すことにも対応しています。

grepl("検索語", 列名, ignore.case = TRUE) として、検索すれば、検索語が現れるものを探してくれます。

```{r}
wdicache$series |> filter(grepl("women and girls", name, ignore.case = TRUE)) |>
  filter(grepl("UNICEF", sourceOrganization, ignore.case = TRUE))
```

大きなファイルなので、保存しておいて、使うとよいのですが、data.frame ではないので、他の方法で保存することが必要です。

```{r eval = FALSE}
write_rds(wdicache, "data/wdicache.rds")
```


### `extra = TRUE`

WDI でデータを読み込む時に、最後に、extra = TRUE とつけると、地域（region）や、所得レベル（income）情報も一緒に読み込んでくれました。実は、これは、2012 年の基準になっており、世界銀行では、これを、毎年、更新しています。その情報も、wdicache に入っています。そこで、extra = TRUE として読み込む時には、次のようにするのがより正確です。

```{r}
ASEAN <- c("BN", "KH", "ID", "LA", "MY", "MM", "PH", "SG", "VN")
```

読み込む時には、国名を指定すれば、データが小さくてすみますから、今回は、ASEAN のデータだけ読んでみましょう。まずは、wdicache なし。


```{r}
df_pcap <- WDI(country = ASEAN, indicator = c(gdppcap = "NY.GDP.PCAP.PP.KD"), extra = TRUE)
df_pcap |> distinct(country, iso2c, region, income)
```



```{r}
df_pcap_cache <- WDI(country = ASEAN, indicator = c(gdppcap = "NY.GDP.PCAP.PP.KD"), extra = TRUE, cache = wdicache)
df_pcap_cache |> distinct(country, iso2c, region, income)
```

_2024年2月20日6:48a.m. 時点で下のようなメッセージが出ます。これは、データアップデートのためのメインテナンスだと思われます。_ _11:20 a.m. では解決されているようです。すべてのデータかどうかは不明ですが。_

```
WDI(indicator = c(gdppcap = "NY.GDP.PCAP.PP.KD"), extra = TRUE) でエラー: 
  The following indicators could not be downloaded: NY.GDP.PCAP.PP.KD.

Please make sure that you are running the latest version of the `WDI` package, and that the arguments you are using in the `WDI()` function are valid.

Sometimes, downloads will suddenly stop working, even if nothing has changed in the R code of the WDI package. ("The same WDI package version worked yesterday!") In those cases, the problem is almost certainly related to the World Bank servers or to your internet connection.

You can check if the World Bank web API is currently serving the indicator(s) of interest by typing a URL of this form in your web browser:

https://api.worldbank.org/v2/en/country/all/indicator/NY.GDP.PCAP.PP.KD?format=json&date=:&per_page=32500&page=1
```

### クラスで使ったデータをダウンロードする方法

1. 次のサイトにアクセスします：[リンク](https://github.com/ds-sl/intro2r/tree/main/docs/ges001/data)
2. データを探します。見つかったら、Download Raw を選択すると、ダウンロードできます。

3. または、Raw を選択します。このページの URL を、Browser の窓から取得します。

例：https://raw.githubusercontent.com/ds-sl/intro2r/main/docs/ges001/data/gini.csv

これを、引用符で囲い、下のように、read_csv で読み込み、データに名前をつけます。あとは、いつもと同じです。

```{r}
df_gini <- read_csv("https://raw.githubusercontent.com/ds-sl/intro2r/main/docs/ges001/data/gini.csv")
df_gini
```

## Advanced 

WDI にアクセスできなかった時には、次のような方法も可能です。

[Bulk Download of World Bank Data](https://ds-sl.github.io/intro2r/da4r/wdi_bulkdownload.nb.html)